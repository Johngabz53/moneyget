(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8596],{91004:function(e){"use strict";for(var t="qpzry9x8gf2tvdw0s3jn54khce6mua7l",r={},i=0;i<t.length;i++){var n=t.charAt(i);if(void 0!==r[n])throw TypeError(n+" is ambiguous");r[n]=i}function s(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function u(e){for(var t=1,r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i<33||i>126)return"Invalid prefix ("+e+")";t=s(t)^i>>5}for(r=0,t=s(t);r<e.length;++r){var n=e.charCodeAt(r);t=s(t)^31&n}return t}function o(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var i=e.toLowerCase(),n=e.toUpperCase();if(e!==i&&e!==n)return"Mixed-case string "+e;var o=(e=i).lastIndexOf("1");if(-1===o)return"No separator character for "+e;if(0===o)return"Missing prefix for "+e;var a=e.slice(0,o),p=e.slice(o+1);if(p.length<6)return"Data too short";var c=u(a);if("string"==typeof c)return c;for(var l=[],h=0;h<p.length;++h){var f=p.charAt(h),d=r[f];if(void 0===d)return"Unknown character "+f;c=s(c)^d,h+6>=p.length||l.push(d)}return 1!==c?"Invalid checksum for "+e:{prefix:a,words:l}}function a(e,t,r,i){for(var n=0,s=0,u=(1<<r)-1,o=[],a=0;a<e.length;++a)for(n=n<<t|e[a],s+=t;s>=r;)o.push(n>>(s-=r)&u);if(i)s>0&&o.push(n<<r-s&u);else{if(s>=t)return"Excess padding";if(n<<r-s&u)return"Non-zero padding"}return o}e.exports={decodeUnsafe:function(){var e=o.apply(null,arguments);if("object"==typeof e)return e},decode:function(e){var t=o.apply(null,arguments);if("object"==typeof t)return t;throw Error(t)},encode:function(e,r,i){if(i=i||90,e.length+7+r.length>i)throw TypeError("Exceeds length limit");var n=u(e=e.toLowerCase());if("string"==typeof n)throw Error(n);for(var o=e+"1",a=0;a<r.length;++a){var p=r[a];if(p>>5!=0)throw Error("Non 5-bit word");n=s(n)^p,o+=t.charAt(p)}for(a=0;a<6;++a)n=s(n);for(n^=1,a=0;a<6;++a){var c=n>>(5-a)*5&31;o+=t.charAt(c)}return o},toWordsUnsafe:function(e){var t=a(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=a(e,8,5,!0);if(Array.isArray(t))return t;throw Error(t)},fromWordsUnsafe:function(e){var t=a(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=a(e,5,8,!1);if(Array.isArray(t))return t;throw Error(t)}}},87620:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(18581);function n(e,t,r){return i=>{if(e.has(i))return;let n=r.filter(e=>e.key.toString("hex")===i)[0];t.push(n),e.add(i)}}function s(e){return e.globalMap.unsignedTx}function u(e){let t=new Set;return e.forEach(e=>{let r=e.key.toString("hex");if(t.has(r))throw Error("Combine: KeyValue Map keys should be unique");t.add(r)}),t}t.combine=function(e){let t=e[0],r=i.psbtToKeyVals(t),o=e.slice(1);if(0===o.length)throw Error("Combine: Nothing to combine");let a=s(t);if(void 0===a)throw Error("Combine: Self missing transaction");let p=u(r.globalKeyVals),c=r.inputKeyVals.map(u),l=r.outputKeyVals.map(u);for(let e of o){let t=s(e);if(void 0===t||!t.toBuffer().equals(a.toBuffer()))throw Error("Combine: One of the Psbts does not have the same transaction.");let o=i.psbtToKeyVals(e),h=u(o.globalKeyVals);h.forEach(n(p,r.globalKeyVals,o.globalKeyVals));let f=o.inputKeyVals.map(u);f.forEach((e,t)=>e.forEach(n(c[t],r.inputKeyVals[t],o.inputKeyVals[t])));let d=o.outputKeyVals.map(u);d.forEach((e,t)=>e.forEach(n(l[t],r.outputKeyVals[t],o.outputKeyVals[t])))}return i.psbtFromKeyVals(a,{globalMapKeyVals:r.globalKeyVals,inputKeyVals:r.inputKeyVals,outputKeyVals:r.outputKeyVals})}},94494:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198),s=e=>[...Array(e).keys()];t.decode=function(e){if(e.key[0]!==n.GlobalTypes.GLOBAL_XPUB)throw Error("Decode Error: could not decode globalXpub with key 0x"+e.key.toString("hex"));if(79!==e.key.length||![2,3].includes(e.key[46]))throw Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+e.key.toString("hex"));if(e.value.length/4%1!=0)throw Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");let t=e.key.slice(1),r={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(let t of s(e.value.length/4-1)){let i=e.value.readUInt32LE(4*t+4),n=!!(2147483648&i),s=2147483647&i;r.path+="/"+s.toString(10)+(n?"'":"")}return r},t.encode=function(e){let t=i.from([n.GlobalTypes.GLOBAL_XPUB]),r=i.concat([t,e.extendedPubkey]),s=e.path.split("/"),u=i.allocUnsafe(4*s.length);e.masterFingerprint.copy(u,0);let o=4;return s.slice(1).forEach(e=>{let t="'"===e.slice(-1),r=2147483647&parseInt(t?e.slice(0,-1):e,10);t&&(r+=2147483648),u.writeUInt32LE(r,o),o+=4}),{key:r,value:u}},t.expected="{ masterFingerprint: Buffer; extendedPubkey: Buffer; path: string; }",t.check=function(e){let t=e.extendedPubkey,r=e.masterFingerprint,n=e.path;return i.isBuffer(t)&&78===t.length&&[2,3].indexOf(t[45])>-1&&i.isBuffer(r)&&4===r.length&&"string"==typeof n&&!!n.match(/^m(\/\d+'?)+$/)},t.canAddToArray=function(e,t,r){let i=t.extendedPubkey.toString("hex");return!r.has(i)&&(r.add(i),0===e.filter(e=>e.extendedPubkey.equals(t.extendedPubkey)).length)}},76573:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.encode=function(e){return{key:i.from([n.GlobalTypes.UNSIGNED_TX]),value:e.toBuffer()}}},5037:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(3198),n=r(94494),s=r(76573),u=r(90643),o=r(33911),a=r(95367),p=r(24034),c=r(39231),l=r(49413),h=r(83904),f=r(9921),d=r(73733),y=r(70262),g=r(69898),m={unsignedTx:s,globalXpub:n,checkPubkey:d.makeChecker([])};t.globals=m;let _={nonWitnessUtxo:a,partialSig:p,sighashType:l,finalScriptSig:u,finalScriptWitness:o,porCommitment:c,witnessUtxo:h,bip32Derivation:f.makeConverter(i.InputTypes.BIP32_DERIVATION),redeemScript:y.makeConverter(i.InputTypes.REDEEM_SCRIPT),witnessScript:g.makeConverter(i.InputTypes.WITNESS_SCRIPT),checkPubkey:d.makeChecker([i.InputTypes.PARTIAL_SIG,i.InputTypes.BIP32_DERIVATION])};t.inputs=_;let S={bip32Derivation:f.makeConverter(i.OutputTypes.BIP32_DERIVATION),redeemScript:y.makeConverter(i.OutputTypes.REDEEM_SCRIPT),witnessScript:g.makeConverter(i.OutputTypes.WITNESS_SCRIPT),checkPubkey:d.makeChecker([i.OutputTypes.BIP32_DERIVATION])};t.outputs=S},90643:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.decode=function(e){if(e.key[0]!==n.InputTypes.FINAL_SCRIPTSIG)throw Error("Decode Error: could not decode finalScriptSig with key 0x"+e.key.toString("hex"));return e.value},t.encode=function(e){let t=i.from([n.InputTypes.FINAL_SCRIPTSIG]);return{key:t,value:e}},t.expected="Buffer",t.check=function(e){return i.isBuffer(e)},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.finalScriptSig}},33911:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.decode=function(e){if(e.key[0]!==n.InputTypes.FINAL_SCRIPTWITNESS)throw Error("Decode Error: could not decode finalScriptWitness with key 0x"+e.key.toString("hex"));return e.value},t.encode=function(e){let t=i.from([n.InputTypes.FINAL_SCRIPTWITNESS]);return{key:t,value:e}},t.expected="Buffer",t.check=function(e){return i.isBuffer(e)},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.finalScriptWitness}},95367:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.decode=function(e){if(e.key[0]!==n.InputTypes.NON_WITNESS_UTXO)throw Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+e.key.toString("hex"));return e.value},t.encode=function(e){return{key:i.from([n.InputTypes.NON_WITNESS_UTXO]),value:e}},t.expected="Buffer",t.check=function(e){return i.isBuffer(e)},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.nonWitnessUtxo}},24034:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.decode=function(e){if(e.key[0]!==n.InputTypes.PARTIAL_SIG)throw Error("Decode Error: could not decode partialSig with key 0x"+e.key.toString("hex"));if(!(34===e.key.length||66===e.key.length)||![2,3,4].includes(e.key[1]))throw Error("Decode Error: partialSig has invalid pubkey in key 0x"+e.key.toString("hex"));let t=e.key.slice(1);return{pubkey:t,signature:e.value}},t.encode=function(e){let t=i.from([n.InputTypes.PARTIAL_SIG]);return{key:i.concat([t,e.pubkey]),value:e.signature}},t.expected="{ pubkey: Buffer; signature: Buffer; }",t.check=function(e){return i.isBuffer(e.pubkey)&&i.isBuffer(e.signature)&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&function(e){if(!i.isBuffer(e)||e.length<9||48!==e[0]||e.length!==e[1]+3||2!==e[2])return!1;let t=e[3];if(t>33||t<1||2!==e[3+t+1])return!1;let r=e[3+t+2];return!(r>33)&&!(r<1)&&e.length===3+t+2+r+2}(e.signature)},t.canAddToArray=function(e,t,r){let i=t.pubkey.toString("hex");return!r.has(i)&&(r.add(i),0===e.filter(e=>e.pubkey.equals(t.pubkey)).length)}},39231:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.decode=function(e){if(e.key[0]!==n.InputTypes.POR_COMMITMENT)throw Error("Decode Error: could not decode porCommitment with key 0x"+e.key.toString("hex"));return e.value.toString("utf8")},t.encode=function(e){let t=i.from([n.InputTypes.POR_COMMITMENT]);return{key:t,value:i.from(e,"utf8")}},t.expected="string",t.check=function(e){return"string"==typeof e},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.porCommitment}},49413:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198);t.decode=function(e){if(e.key[0]!==n.InputTypes.SIGHASH_TYPE)throw Error("Decode Error: could not decode sighashType with key 0x"+e.key.toString("hex"));return e.value.readUInt32LE(0)},t.encode=function(e){let t=i.from([n.InputTypes.SIGHASH_TYPE]),r=i.allocUnsafe(4);return r.writeUInt32LE(e,0),{key:t,value:r}},t.expected="number",t.check=function(e){return"number"==typeof e},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.sighashType}},83904:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(3198),s=r(40944),u=r(30941);t.decode=function(e){if(e.key[0]!==n.InputTypes.WITNESS_UTXO)throw Error("Decode Error: could not decode witnessUtxo with key 0x"+e.key.toString("hex"));let t=s.readUInt64LE(e.value,0),r=8,i=u.decode(e.value,r);r+=u.encodingLength(i);let o=e.value.slice(r);if(o.length!==i)throw Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:o,value:t}},t.encode=function(e){let{script:t,value:r}=e,o=u.encodingLength(t.length),a=i.allocUnsafe(8+o+t.length);return s.writeUInt64LE(a,r,0),u.encode(t.length,a,8),t.copy(a,8+o),{key:i.from([n.InputTypes.WITNESS_UTXO]),value:a}},t.expected="{ script: Buffer; value: number; }",t.check=function(e){return i.isBuffer(e.script)&&"number"==typeof e.value},t.canAdd=function(e,t){return!!e&&!!t&&void 0===e.witnessUtxo}},9921:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=e=>[...Array(e).keys()];t.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw Error("Decode Error: could not decode bip32Derivation with key 0x"+t.key.toString("hex"));if(!(34===t.key.length||66===t.key.length)||![2,3,4].includes(t.key[1]))throw Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+t.key.toString("hex"));if(t.value.length/4%1!=0)throw Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");let r=t.key.slice(1),i={masterFingerprint:t.value.slice(0,4),pubkey:r,path:"m"};for(let e of n(t.value.length/4-1)){let r=t.value.readUInt32LE(4*e+4),n=!!(2147483648&r),s=2147483647&r;i.path+="/"+s.toString(10)+(n?"'":"")}return i},encode:function(t){let r=i.from([e]),n=i.concat([r,t.pubkey]),s=t.path.split("/"),u=i.allocUnsafe(4*s.length);t.masterFingerprint.copy(u,0);let o=4;return s.slice(1).forEach(e=>{let t="'"===e.slice(-1),r=2147483647&parseInt(t?e.slice(0,-1):e,10);t&&(r+=2147483648),u.writeUInt32LE(r,o),o+=4}),{key:n,value:u}},check:function(e){return i.isBuffer(e.pubkey)&&i.isBuffer(e.masterFingerprint)&&"string"==typeof e.path&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&4===e.masterFingerprint.length},expected:"{ masterFingerprint: Buffer; pubkey: Buffer; path: string; }",canAddToArray:function(e,t,r){let i=t.pubkey.toString("hex");return!r.has(i)&&(r.add(i),0===e.filter(e=>e.pubkey.equals(t.pubkey)).length)}}}},73733:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeChecker=function(e){return function(t){let r;if(e.includes(t.key[0])&&(!(33===(r=t.key.slice(1)).length||65===r.length)||![2,3,4].includes(r[0])))throw Error("Format Error: invalid pubkey in key 0x"+t.key.toString("hex"));return r}}},70262:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw Error("Decode Error: could not decode redeemScript with key 0x"+t.key.toString("hex"));return t.value},encode:function(t){let r=i.from([e]);return{key:r,value:t}},check:function(e){return i.isBuffer(e)},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.redeemScript}}}},69898:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.makeConverter=function(e){return{decode:function(t){if(t.key[0]!==e)throw Error("Decode Error: could not decode witnessScript with key 0x"+t.key.toString("hex"));return t.value},encode:function(t){let r=i.from([e]);return{key:r,value:t}},check:function(e){return i.isBuffer(e)},expected:"Buffer",canAdd:function(e,t){return!!e&&!!t&&void 0===e.witnessScript}}}},40944:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(30941);function s(e){let t=e.key.length,r=e.value.length,s=n.encodingLength(t),u=n.encodingLength(r),o=i.allocUnsafe(s+t+u+r);return n.encode(t,o,0),e.key.copy(o,s),n.encode(r,o,s+t),e.value.copy(o,s+t+u),o}function u(e,t){if("number"!=typeof e)throw Error("cannot write a non-number as a number");if(e<0)throw Error("specified a negative value for writing an unsigned value");if(e>t)throw Error("RangeError: value out of range");if(Math.floor(e)!==e)throw Error("value has a fractional component")}t.range=e=>[...Array(e).keys()],t.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let i=0;i<e.length/2;i++)r=e[i],e[i]=e[t],e[t]=r,t--;return e},t.keyValsToBuffer=function(e){let t=e.map(s);return t.push(i.from([0])),i.concat(t)},t.keyValToBuffer=s,t.readUInt64LE=function(e,t){let r=e.readUInt32LE(t),i=e.readUInt32LE(t+4);return u((i*=4294967296)+r,9007199254740991),i+r},t.writeUInt64LE=function(e,t,r){return u(t,9007199254740991),e.writeInt32LE(-1&t,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}},30941:function(e,t,r){"use strict";var i=r(1684).Buffer;function n(e){if(e<0||e>9007199254740991||e%1!=0)throw RangeError("value out of range")}function s(e){return n(e),e<253?1:e<=65535?3:e<=4294967295?5:9}Object.defineProperty(t,"__esModule",{value:!0}),t.encode=function e(t,r,u){if(n(t),r||(r=i.allocUnsafe(s(t))),!i.isBuffer(r))throw TypeError("buffer must be a Buffer instance");return u||(u=0),t<253?(r.writeUInt8(t,u),Object.assign(e,{bytes:1})):t<=65535?(r.writeUInt8(253,u),r.writeUInt16LE(t,u+1),Object.assign(e,{bytes:3})):t<=4294967295?(r.writeUInt8(254,u),r.writeUInt32LE(t,u+1),Object.assign(e,{bytes:5})):(r.writeUInt8(255,u),r.writeUInt32LE(t>>>0,u+1),r.writeUInt32LE(t/4294967296|0,u+5),Object.assign(e,{bytes:9})),r},t.decode=function e(t,r){if(!i.isBuffer(t))throw TypeError("buffer must be a Buffer instance");r||(r=0);let s=t.readUInt8(r);if(s<253)return Object.assign(e,{bytes:1}),s;if(253===s)return Object.assign(e,{bytes:3}),t.readUInt16LE(r+1);if(254===s)return Object.assign(e,{bytes:5}),t.readUInt32LE(r+1);{Object.assign(e,{bytes:9});let i=t.readUInt32LE(r+1),s=t.readUInt32LE(r+5),u=4294967296*s+i;return n(u),u}},t.encodingLength=s},58543:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(5037),s=r(40944),u=r(30941),o=r(3198);function a(e,t,r){if(!t.equals(i.from([r])))throw Error(`Format Error: Invalid ${e} key: ${t.toString("hex")}`)}function p(e,{globalMapKeyVals:t,inputKeyVals:r,outputKeyVals:i}){let u={unsignedTx:e},p=0;for(let e of t)switch(e.key[0]){case o.GlobalTypes.UNSIGNED_TX:if(a("global",e.key,o.GlobalTypes.UNSIGNED_TX),p>0)throw Error("Format Error: GlobalMap has multiple UNSIGNED_TX");p++;break;case o.GlobalTypes.GLOBAL_XPUB:void 0===u.globalXpub&&(u.globalXpub=[]),u.globalXpub.push(n.globals.globalXpub.decode(e));break;default:u.unknownKeyVals||(u.unknownKeyVals=[]),u.unknownKeyVals.push(e)}let c=r.length,l=i.length,h=[],f=[];for(let e of s.range(c)){let t={};for(let i of r[e])switch(n.inputs.checkPubkey(i),i.key[0]){case o.InputTypes.NON_WITNESS_UTXO:if(a("input",i.key,o.InputTypes.NON_WITNESS_UTXO),void 0!==t.nonWitnessUtxo)throw Error("Format Error: Input has multiple NON_WITNESS_UTXO");t.nonWitnessUtxo=n.inputs.nonWitnessUtxo.decode(i);break;case o.InputTypes.WITNESS_UTXO:if(a("input",i.key,o.InputTypes.WITNESS_UTXO),void 0!==t.witnessUtxo)throw Error("Format Error: Input has multiple WITNESS_UTXO");t.witnessUtxo=n.inputs.witnessUtxo.decode(i);break;case o.InputTypes.PARTIAL_SIG:void 0===t.partialSig&&(t.partialSig=[]),t.partialSig.push(n.inputs.partialSig.decode(i));break;case o.InputTypes.SIGHASH_TYPE:if(a("input",i.key,o.InputTypes.SIGHASH_TYPE),void 0!==t.sighashType)throw Error("Format Error: Input has multiple SIGHASH_TYPE");t.sighashType=n.inputs.sighashType.decode(i);break;case o.InputTypes.REDEEM_SCRIPT:if(a("input",i.key,o.InputTypes.REDEEM_SCRIPT),void 0!==t.redeemScript)throw Error("Format Error: Input has multiple REDEEM_SCRIPT");t.redeemScript=n.inputs.redeemScript.decode(i);break;case o.InputTypes.WITNESS_SCRIPT:if(a("input",i.key,o.InputTypes.WITNESS_SCRIPT),void 0!==t.witnessScript)throw Error("Format Error: Input has multiple WITNESS_SCRIPT");t.witnessScript=n.inputs.witnessScript.decode(i);break;case o.InputTypes.BIP32_DERIVATION:void 0===t.bip32Derivation&&(t.bip32Derivation=[]),t.bip32Derivation.push(n.inputs.bip32Derivation.decode(i));break;case o.InputTypes.FINAL_SCRIPTSIG:a("input",i.key,o.InputTypes.FINAL_SCRIPTSIG),t.finalScriptSig=n.inputs.finalScriptSig.decode(i);break;case o.InputTypes.FINAL_SCRIPTWITNESS:a("input",i.key,o.InputTypes.FINAL_SCRIPTWITNESS),t.finalScriptWitness=n.inputs.finalScriptWitness.decode(i);break;case o.InputTypes.POR_COMMITMENT:a("input",i.key,o.InputTypes.POR_COMMITMENT),t.porCommitment=n.inputs.porCommitment.decode(i);break;default:t.unknownKeyVals||(t.unknownKeyVals=[]),t.unknownKeyVals.push(i)}h.push(t)}for(let e of s.range(l)){let t={};for(let r of i[e])switch(n.outputs.checkPubkey(r),r.key[0]){case o.OutputTypes.REDEEM_SCRIPT:if(a("output",r.key,o.OutputTypes.REDEEM_SCRIPT),void 0!==t.redeemScript)throw Error("Format Error: Output has multiple REDEEM_SCRIPT");t.redeemScript=n.outputs.redeemScript.decode(r);break;case o.OutputTypes.WITNESS_SCRIPT:if(a("output",r.key,o.OutputTypes.WITNESS_SCRIPT),void 0!==t.witnessScript)throw Error("Format Error: Output has multiple WITNESS_SCRIPT");t.witnessScript=n.outputs.witnessScript.decode(r);break;case o.OutputTypes.BIP32_DERIVATION:void 0===t.bip32Derivation&&(t.bip32Derivation=[]),t.bip32Derivation.push(n.outputs.bip32Derivation.decode(r));break;default:t.unknownKeyVals||(t.unknownKeyVals=[]),t.unknownKeyVals.push(r)}f.push(t)}return{globalMap:u,inputs:h,outputs:f}}t.psbtFromBuffer=function(e,t){let r=0;function i(){let t=u.decode(e,r);r+=u.encodingLength(t);let i=e.slice(r,r+t);return r+=t,i}function n(){let e=i(),t=i();return{key:e,value:t}}function a(){if(r>=e.length)throw Error("Format Error: Unexpected End of PSBT");let t=0===e.readUInt8(r);return t&&r++,t}if(1886610036!==function(){let t=e.readUInt32BE(r);return r+=4,t}())throw Error("Format Error: Invalid Magic Number");if(255!==function(){let t=e.readUInt8(r);return r+=1,t}())throw Error("Format Error: Magic Number must be followed by 0xff separator");let c=[],l={};for(;!a();){let e=n(),t=e.key.toString("hex");if(l[t])throw Error("Format Error: Keys must be unique for global keymap: key "+t);l[t]=1,c.push(e)}let h=c.filter(e=>e.key[0]===o.GlobalTypes.UNSIGNED_TX);if(1!==h.length)throw Error("Format Error: Only one UNSIGNED_TX allowed");let f=t(h[0].value),{inputCount:d,outputCount:y}=f.getInputOutputCounts(),g=[],m=[];for(let e of s.range(d)){let t={},r=[];for(;!a();){let i=n(),s=i.key.toString("hex");if(t[s])throw Error("Format Error: Keys must be unique for each input: input index "+e+" key "+s);t[s]=1,r.push(i)}g.push(r)}for(let e of s.range(y)){let t={},r=[];for(;!a();){let i=n(),s=i.key.toString("hex");if(t[s])throw Error("Format Error: Keys must be unique for each output: output index "+e+" key "+s);t[s]=1,r.push(i)}m.push(r)}return p(f,{globalMapKeyVals:c,inputKeyVals:g,outputKeyVals:m})},t.checkKeyBuffer=a,t.psbtFromKeyVals=p},18581:function(e,t,r){"use strict";function i(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),i(r(58543)),i(r(31078))},31078:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(5037),s=r(40944);t.psbtToBuffer=function({globalMap:e,inputs:t,outputs:r}){let{globalKeyVals:n,inputKeyVals:u,outputKeyVals:o}=a({globalMap:e,inputs:t,outputs:r}),p=s.keyValsToBuffer(n),c=e=>0===e.length?[i.from([0])]:e.map(s.keyValsToBuffer),l=c(u),h=c(o),f=i.allocUnsafe(5);return f.writeUIntBE(482972169471,0,5),i.concat([f,p].concat(l,h))};let u=(e,t)=>e.key.compare(t.key);function o(e,t){let r=new Set,i=Object.entries(e).reduce((e,[i,n])=>{if("unknownKeyVals"===i)return e;let s=t[i];if(void 0===s)return e;let u=(Array.isArray(n)?n:[n]).map(s.encode),o=u.map(e=>e.key.toString("hex"));return o.forEach(e=>{if(r.has(e))throw Error("Serialize Error: Duplicate key: "+e);r.add(e)}),e.concat(u)},[]),n=e.unknownKeyVals?e.unknownKeyVals.filter(e=>!r.has(e.key.toString("hex"))):[];return i.concat(n).sort(u)}function a({globalMap:e,inputs:t,outputs:r}){return{globalKeyVals:o(e,n.globals),inputKeyVals:t.map(e=>o(e,n.inputs)),outputKeyVals:r.map(e=>o(e,n.outputs))}}t.psbtToKeyVals=a},51124:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(87620),s=r(18581),u=r(3198),o=r(70988);t.Psbt=class{constructor(e){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:e}}static fromBase64(e,t){let r=i.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t){let r=i.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t){let r=s.psbtFromBuffer(e,t),i=new this(r.globalMap.unsignedTx);return Object.assign(i,r),i}toBase64(){let e=this.toBuffer();return e.toString("base64")}toHex(){let e=this.toBuffer();return e.toString("hex")}toBuffer(){return s.psbtToBuffer(this)}updateGlobal(e){return o.updateGlobal(e,this.globalMap),this}updateInput(e,t){let r=o.checkForInput(this.inputs,e);return o.updateInput(t,r),this}updateOutput(e,t){let r=o.checkForOutput(this.outputs,e);return o.updateOutput(t,r),this}addUnknownKeyValToGlobal(e){return o.checkHasKey(e,this.globalMap.unknownKeyVals,o.getEnumLength(u.GlobalTypes)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(e),this}addUnknownKeyValToInput(e,t){let r=o.checkForInput(this.inputs,e);return o.checkHasKey(t,r.unknownKeyVals,o.getEnumLength(u.InputTypes)),r.unknownKeyVals||(r.unknownKeyVals=[]),r.unknownKeyVals.push(t),this}addUnknownKeyValToOutput(e,t){let r=o.checkForOutput(this.outputs,e);return o.checkHasKey(t,r.unknownKeyVals,o.getEnumLength(u.OutputTypes)),r.unknownKeyVals||(r.unknownKeyVals=[]),r.unknownKeyVals.push(t),this}addInput(e){this.globalMap.unsignedTx.addInput(e),this.inputs.push({unknownKeyVals:[]});let t=e.unknownKeyVals||[],r=this.inputs.length-1;if(!Array.isArray(t))throw Error("unknownKeyVals must be an Array");return t.forEach(e=>this.addUnknownKeyValToInput(r,e)),o.addInputAttributes(this.inputs,e),this}addOutput(e){this.globalMap.unsignedTx.addOutput(e),this.outputs.push({unknownKeyVals:[]});let t=e.unknownKeyVals||[],r=this.outputs.length-1;if(!Array.isArray(t))throw Error("unknownKeyVals must be an Array");return t.forEach(e=>this.addUnknownKeyValToInput(r,e)),o.addOutputAttributes(this.outputs,e),this}clearFinalizedInput(e){let t=o.checkForInput(this.inputs,e);for(let r of(o.inputCheckUncleanFinalized(e,t),Object.keys(t)))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(r)||delete t[r];return this}combine(...e){let t=n.combine([this].concat(e));return Object.assign(this,t),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}}},3198:function(e,t){"use strict";var r,i,n;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.GlobalTypes||(t.GlobalTypes={}))[r.UNSIGNED_TX=0]="UNSIGNED_TX",r[r.GLOBAL_XPUB=1]="GLOBAL_XPUB",t.GLOBAL_TYPE_NAMES=["unsignedTx","globalXpub"],(i=t.InputTypes||(t.InputTypes={}))[i.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",i[i.WITNESS_UTXO=1]="WITNESS_UTXO",i[i.PARTIAL_SIG=2]="PARTIAL_SIG",i[i.SIGHASH_TYPE=3]="SIGHASH_TYPE",i[i.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",i[i.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",i[i.BIP32_DERIVATION=6]="BIP32_DERIVATION",i[i.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",i[i.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",i[i.POR_COMMITMENT=9]="POR_COMMITMENT",t.INPUT_TYPE_NAMES=["nonWitnessUtxo","witnessUtxo","partialSig","sighashType","redeemScript","witnessScript","bip32Derivation","finalScriptSig","finalScriptWitness","porCommitment"],(n=t.OutputTypes||(t.OutputTypes={}))[n.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",n[n.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",n[n.BIP32_DERIVATION=2]="BIP32_DERIVATION",t.OUTPUT_TYPE_NAMES=["redeemScript","witnessScript","bip32Derivation"]},70988:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(5037);function s(e,t){let r=e[t];if(void 0===r)throw Error(`No input #${t}`);return r}function u(e,t,r,i){throw Error(`Data for ${e} key ${t} is incorrect: Expected ${r} and got ${JSON.stringify(i)}`)}function o(e){return(t,r)=>{for(let i of Object.keys(t)){let s=t[i],{canAdd:o,canAddToArray:a,check:p,expected:c}=n[e+"s"][i]||{},l=!!a;if(p){if(l){if(!Array.isArray(s)||r[i]&&!Array.isArray(r[i]))throw Error(`Key type ${i} must be an array`);s.every(p)||u(e,i,c,s);let t=r[i]||[],n=new Set;if(!s.every(e=>a(t,e,n)))throw Error("Can not add duplicate data to array");r[i]=t.concat(s)}else{if(p(s)||u(e,i,c,s),!o(r,s))throw Error(`Can not add duplicate data to ${e}`);r[i]=s}}}}}t.checkForInput=s,t.checkForOutput=function(e,t){let r=e[t];if(void 0===r)throw Error(`No output #${t}`);return r},t.checkHasKey=function(e,t,r){if(e.key[0]<r)throw Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&0!==t.filter(t=>t.key.equals(e.key)).length)throw Error(`Duplicate Key: ${e.key.toString("hex")}`)},t.getEnumLength=function(e){let t=0;return Object.keys(e).forEach(e=>{Number(isNaN(Number(e)))&&t++}),t},t.inputCheckUncleanFinalized=function(e,t){let r=!1;if(t.nonWitnessUtxo||t.witnessUtxo){let e=!!t.redeemScript,i=!!t.witnessScript,n=!e||!!t.finalScriptSig,s=!i||!!t.finalScriptWitness,u=!!t.finalScriptSig||!!t.finalScriptWitness;r=n&&s&&u}if(!1===r)throw Error(`Input #${e} has too much or too little data to clean`)},t.updateGlobal=o("global"),t.updateInput=o("input"),t.updateOutput=o("output"),t.addInputAttributes=function(e,r){let i=e.length-1,n=s(e,i);t.updateInput(r,n)},t.addOutputAttributes=function(e,r){let i=e.length-1,n=s(e,i);t.updateOutput(r,n)},t.defaultVersionSetter=function(e,t){if(!i.isBuffer(t)||t.length<4)throw Error("Set Version: Invalid Transaction");return t.writeUInt32LE(e,0),t},t.defaultLocktimeSetter=function(e,t){if(!i.isBuffer(t)||t.length<4)throw Error("Set Locktime: Invalid Transaction");return t.writeUInt32LE(e,t.length-4),t}},42679:function(e,t,r){var i=r(70964).Buffer;e.exports={check:function(e){if(e.length<8||e.length>72||48!==e[0]||e[1]!==e.length-2||2!==e[2])return!1;var t=e[3];if(0===t||5+t>=e.length||2!==e[4+t])return!1;var r=e[5+t];return 0!==r&&6+t+r===e.length&&!(128&e[4])&&(!(t>1)||0!==e[4]||!!(128&e[5]))&&!(128&e[t+6])&&(!(r>1)||0!==e[t+6]||!!(128&e[t+7]))},decode:function(e){if(e.length<8)throw Error("DER sequence length is too short");if(e.length>72)throw Error("DER sequence length is too long");if(48!==e[0])throw Error("Expected DER sequence");if(e[1]!==e.length-2)throw Error("DER sequence length is invalid");if(2!==e[2])throw Error("Expected DER integer");var t=e[3];if(0===t)throw Error("R length is zero");if(5+t>=e.length)throw Error("R length is too long");if(2!==e[4+t])throw Error("Expected DER integer (2)");var r=e[5+t];if(0===r)throw Error("S length is zero");if(6+t+r!==e.length)throw Error("S length is invalid");if(128&e[4])throw Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw Error("R value excessively padded");if(128&e[t+6])throw Error("S value is negative");if(r>1&&0===e[t+6]&&!(128&e[t+7]))throw Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},encode:function(e,t){var r=e.length,n=t.length;if(0===r)throw Error("R length is zero");if(0===n)throw Error("S length is zero");if(r>33)throw Error("R length is too long");if(n>33)throw Error("S length is too long");if(128&e[0])throw Error("R value is negative");if(128&t[0])throw Error("S value is negative");if(r>1&&0===e[0]&&!(128&e[1]))throw Error("R value excessively padded");if(n>1&&0===t[0]&&!(128&t[1]))throw Error("S value excessively padded");var s=i.allocUnsafe(6+r+n);return s[0]=48,s[1]=s.length-2,s[2]=2,s[3]=e.length,e.copy(s,4),s[4+r]=2,s[5+r]=t.length,t.copy(s,6+r),s}}},68221:function(e,t,r){var i=r(39991),n={};for(var s in i)n[i[s]]=s;e.exports=n},78305:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(88909),s=r(76109),u=r(48644),o=r(11972),a=r(91004),p=r(87484),c=r(71764);function l(e){let t=p.decode(e);if(t.length<21)throw TypeError(e+" is too short");if(t.length>21)throw TypeError(e+" is too long");let r=t.readUInt8(0),i=t.slice(1);return{version:r,hash:i}}function h(e){let t=a.decode(e),r=a.fromWords(t.words.slice(1));return{version:t.words[0],prefix:t.prefix,data:i.from(r)}}t.fromBase58Check=l,t.fromBech32=h,t.toBase58Check=function(e,t){c(o.tuple(o.Hash160bit,o.UInt8),arguments);let r=i.allocUnsafe(21);return r.writeUInt8(t,0),e.copy(r,1),p.encode(r)},t.toBech32=function(e,t,r){let i=a.toWords(e);return i.unshift(t),a.encode(r,i)},t.fromOutputScript=function(e,t){t=t||n.bitcoin;try{return s.p2pkh({output:e,network:t}).address}catch(e){}try{return s.p2sh({output:e,network:t}).address}catch(e){}try{return s.p2wpkh({output:e,network:t}).address}catch(e){}try{return s.p2wsh({output:e,network:t}).address}catch(e){}throw Error(u.toASM(e)+" has no matching Address")},t.toOutputScript=function(e,t){let r,i;t=t||n.bitcoin;try{r=l(e)}catch(e){}if(r){if(r.version===t.pubKeyHash)return s.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return s.p2sh({hash:r.hash}).output}else{try{i=h(e)}catch(e){}if(i){if(i.prefix!==t.bech32)throw Error(e+" has an invalid prefix");if(0===i.version){if(20===i.data.length)return s.p2wpkh({hash:i.data}).output;if(32===i.data.length)return s.p2wsh({hash:i.data}).output}}}throw Error(e+" has no matching Script")}},47343:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(54372),s=r(66432),u=r(92789),o=r(11972),a=r(4045),p=r(71764),c=r(61258),l=TypeError("Cannot compute merkle root for zero transactions"),h=TypeError("Cannot compute witness commit for non-segwit block");class f{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(e){if(e.length<80)throw Error("Buffer too small (< 80 bytes)");let t=new n.BufferReader(e),r=new f;if(r.version=t.readInt32(),r.prevHash=t.readSlice(32),r.merkleRoot=t.readSlice(32),r.timestamp=t.readUInt32(),r.bits=t.readUInt32(),r.nonce=t.readUInt32(),80===e.length)return r;let i=()=>{let e=u.Transaction.fromBuffer(t.buffer.slice(t.offset),!0);return t.offset+=e.byteLength(),e},s=t.readVarInt();r.transactions=[];for(let e=0;e<s;++e){let e=i();r.transactions.push(e)}let o=r.getWitnessCommit();return o&&(r.witnessCommit=o),r}static fromHex(e){return f.fromBuffer(i.from(e,"hex"))}static calculateTarget(e){let t=i.alloc(32,0);return t.writeUIntBE(8388607&e,29-(((4278190080&e)>>24)-3),3),t}static calculateMerkleRoot(e,t){if(p([{getHash:o.Function}],e),0===e.length)throw l;if(t&&!d(e))throw h;let r=e.map(e=>e.getHash(t)),n=a(r,s.hash256);return t?s.hash256(i.concat([n,e[0].ins[0].witness[0]])):n}getWitnessCommit(){if(!d(this.transactions))return null;let e=this.transactions[0].outs.filter(e=>e.script.slice(0,6).equals(i.from("6a24aa21a9ed","hex"))).map(e=>e.script.slice(6,38));if(0===e.length)return null;let t=e[e.length-1];return t instanceof i&&32===t.length?t:null}hasWitnessCommit(){return this.witnessCommit instanceof i&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){var e;return(e=this.transactions)instanceof Array&&e.some(e=>"object"==typeof e&&e.ins instanceof Array&&e.ins.some(e=>"object"==typeof e&&e.witness instanceof Array&&e.witness.length>0))}weight(){let e=this.byteLength(!1,!1),t=this.byteLength(!1,!0);return 3*e+t}byteLength(e,t=!0){return e||!this.transactions?80:80+c.encodingLength(this.transactions.length)+this.transactions.reduce((e,r)=>e+r.byteLength(t),0)}getHash(){return s.hash256(this.toBuffer(!0))}getId(){return n.reverseBuffer(this.getHash()).toString("hex")}getUTCDate(){let e=new Date(0);return e.setUTCSeconds(this.timestamp),e}toBuffer(e){let t=i.allocUnsafe(this.byteLength(e)),r=new n.BufferWriter(t);return r.writeInt32(this.version),r.writeSlice(this.prevHash),r.writeSlice(this.merkleRoot),r.writeUInt32(this.timestamp),r.writeUInt32(this.bits),r.writeUInt32(this.nonce),e||!this.transactions||(c.encode(this.transactions.length,t,r.offset),r.offset+=c.encode.bytes,this.transactions.forEach(e=>{let i=e.byteLength();e.toBuffer(t,r.offset),r.offset+=i})),t}toHex(e){return this.toBuffer(e).toString("hex")}checkTxRoots(){let e=this.hasWitnessCommit();return!(!e&&this.hasWitness())&&this.__checkMerkleRoot()&&(!e||this.__checkWitnessCommit())}checkProofOfWork(){let e=n.reverseBuffer(this.getHash()),t=f.calculateTarget(this.bits);return 0>=e.compare(t)}__checkMerkleRoot(){if(!this.transactions)throw l;let e=f.calculateMerkleRoot(this.transactions);return 0===this.merkleRoot.compare(e)}__checkWitnessCommit(){if(!this.transactions)throw l;if(!this.hasWitnessCommit())throw h;let e=f.calculateMerkleRoot(this.transactions,!0);return 0===this.witnessCommit.compare(e)}}function d(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}t.Block=f},54372:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(11972),s=r(71764),u=r(61258);function o(e,t){if("number"!=typeof e)throw Error("cannot write a non-number as a number");if(e<0)throw Error("specified a negative value for writing an unsigned value");if(e>t)throw Error("RangeError: value out of range");if(Math.floor(e)!==e)throw Error("value has a fractional component")}function a(e,t){let r=e.readUInt32LE(t),i=e.readUInt32LE(t+4);return o((i*=4294967296)+r,9007199254740991),i+r}function p(e,t,r){return o(t,9007199254740991),e.writeInt32LE(-1&t,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}t.readUInt64LE=a,t.writeUInt64LE=p,t.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let i=0;i<e.length/2;i++)r=e[i],e[i]=e[t],e[t]=r,t--;return e},t.cloneBuffer=function(e){let t=i.allocUnsafe(e.length);return e.copy(t),t},t.BufferWriter=class{constructor(e,t=0){this.buffer=e,this.offset=t,s(n.tuple(n.Buffer,n.UInt32),[e,t])}writeUInt8(e){this.offset=this.buffer.writeUInt8(e,this.offset)}writeInt32(e){this.offset=this.buffer.writeInt32LE(e,this.offset)}writeUInt32(e){this.offset=this.buffer.writeUInt32LE(e,this.offset)}writeUInt64(e){this.offset=p(this.buffer,e,this.offset)}writeVarInt(e){u.encode(e,this.buffer,this.offset),this.offset+=u.encode.bytes}writeSlice(e){if(this.buffer.length<this.offset+e.length)throw Error("Cannot write slice out of bounds");this.offset+=e.copy(this.buffer,this.offset)}writeVarSlice(e){this.writeVarInt(e.length),this.writeSlice(e)}writeVector(e){this.writeVarInt(e.length),e.forEach(e=>this.writeVarSlice(e))}},t.BufferReader=class{constructor(e,t=0){this.buffer=e,this.offset=t,s(n.tuple(n.Buffer,n.UInt32),[e,t])}readUInt8(){let e=this.buffer.readUInt8(this.offset);return this.offset++,e}readInt32(){let e=this.buffer.readInt32LE(this.offset);return this.offset+=4,e}readUInt32(){let e=this.buffer.readUInt32LE(this.offset);return this.offset+=4,e}readUInt64(){let e=a(this.buffer,this.offset);return this.offset+=8,e}readVarInt(){let e=u.decode(this.buffer,this.offset);return this.offset+=u.decode.bytes,e}readSlice(e){if(this.buffer.length<this.offset+e)throw Error("Cannot read slice out of bounds");let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){let e=this.readVarInt(),t=[];for(let r=0;r<e;r++)t.push(this.readVarSlice());return t}}},41783:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(91032),s=r(35939),u=r(93263),o=r(13986),a=r(64022),p=r(63925),c=r(76377),l=r(83125),h={P2MS:"multisig",NONSTANDARD:"nonstandard",NULLDATA:"nulldata",P2PK:"pubkey",P2PKH:"pubkeyhash",P2SH:"scripthash",P2WPKH:"witnesspubkeyhash",P2WSH:"witnessscripthash",WITNESS_COMMITMENT:"witnesscommitment"};t.types=h,t.output=function(e){if(c.output.check(e))return h.P2WPKH;if(l.output.check(e))return h.P2WSH;if(o.output.check(e))return h.P2PKH;if(a.output.check(e))return h.P2SH;let t=i.decompile(e);if(!t)throw TypeError("Invalid script");return n.output.check(t)?h.P2MS:u.output.check(t)?h.P2PK:p.output.check(t)?h.WITNESS_COMMITMENT:s.output.check(t)?h.NULLDATA:h.NONSTANDARD},t.input=function(e,t){let r=i.decompile(e);if(!r)throw TypeError("Invalid script");return o.input.check(r)?h.P2PKH:a.input.check(r,t)?h.P2SH:n.input.check(r,t)?h.P2MS:u.input.check(r)?h.P2PK:h.NONSTANDARD},t.witness=function(e,t){let r=i.decompile(e);if(!r)throw TypeError("Invalid script");return c.input.check(r)?h.P2WPKH:l.input.check(r,t)?h.P2WSH:h.NONSTANDARD}},66432:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(93533);function n(e){try{return i("rmd160").update(e).digest()}catch(t){return i("ripemd160").update(e).digest()}}function s(e){return i("sha256").update(e).digest()}t.ripemd160=n,t.sha1=function(e){return i("sha1").update(e).digest()},t.sha256=s,t.hash160=function(e){return n(s(e))},t.hash256=function(e){return s(s(e))}},6091:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(88909),s=r(11972),u=r(99390),o=r(8768),a=r(71764),p=r(39630),c=a.maybe(a.compile({compressed:s.maybe(s.Boolean),network:s.maybe(s.Network)}));class l{constructor(e,t,r){this.__D=e,this.__Q=t,this.lowR=!1,void 0===r&&(r={}),this.compressed=void 0===r.compressed||r.compressed,this.network=r.network||n.bitcoin,void 0!==t&&(this.__Q=u.pointCompress(t,this.compressed))}get privateKey(){return this.__D}get publicKey(){return this.__Q||(this.__Q=u.pointFromScalar(this.__D,this.compressed)),this.__Q}toWIF(){if(!this.__D)throw Error("Missing private key");return p.encode(this.network.wif,this.__D,this.compressed)}sign(e,t){if(!this.__D)throw Error("Missing private key");if(void 0===t&&(t=this.lowR),!1===t)return u.sign(e,this.__D);{let t=u.sign(e,this.__D),r=i.alloc(32,0),n=0;for(;t[0]>127;)n++,r.writeUIntLE(n,0,6),t=u.signWithEntropy(e,this.__D,r);return t}}verify(e,t){return u.verify(e,this.publicKey,t)}}function h(e,t){if(a(s.Buffer256bit,e),!u.isPrivate(e))throw TypeError("Private key not in range [1, n)");return a(c,t),new l(e,void 0,t)}t.fromPrivateKey=h,t.fromPublicKey=function(e,t){return a(u.isPoint,e),a(c,t),new l(void 0,e,t)},t.fromWIF=function(e,t){let r=p.decode(e),i=r.version;if(s.Array(t)){if(!(t=t.filter(e=>i===e.wif).pop()))throw Error("Unknown network version")}else if(i!==(t=t||n.bitcoin).wif)throw Error("Invalid network version");return h(r.privateKey,{compressed:r.compressed,network:t})},t.makeRandom=function(e){let t;a(c,e),void 0===e&&(e={});let r=e.rng||o;do t=r(32),a(s.Buffer256bit,t);while(!u.isPrivate(t));return h(t,e)}},28596:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(74810);t.bip32=i;let n=r(78305);t.address=n;let s=r(66432);t.crypto=s;let u=r(6091);t.ECPair=u;let o=r(88909);t.networks=o;let a=r(76109);t.payments=a;let p=r(48644);t.script=p;var c=r(47343);t.Block=c.Block;var l=r(78700);t.Psbt=l.Psbt;var h=r(48644);t.opcodes=h.OPS;var f=r(92789);t.Transaction=f.Transaction;var d=r(53360);t.TransactionBuilder=d.TransactionBuilder},88909:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},t.regtest={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},t.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},49986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(88909),n=r(48644),s=r(97570),u=r(71764),o=n.OPS;t.p2data=function(e,t){if(!e.data&&!e.output)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),u({network:u.maybe(u.Object),output:u.maybe(u.Buffer),data:u.maybe(u.arrayOf(u.Buffer))},e);let r=e.network||i.bitcoin,a={name:"embed",network:r};if(s.prop(a,"output",()=>{if(e.data)return n.compile([o.OP_RETURN].concat(e.data))}),s.prop(a,"data",()=>{if(e.output)return n.decompile(e.output).slice(1)}),t.validate&&e.output){var p,c;let t=n.decompile(e.output);if(t[0]!==o.OP_RETURN||!t.slice(1).every(u.Buffer))throw TypeError("Output is invalid");if(e.data&&(p=e.data,c=a.data,!(p.length===c.length&&p.every((e,t)=>e.equals(c[t])))))throw TypeError("Data mismatch")}return Object.assign(a,e)}},76109:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(49986);t.embed=i.p2data;let n=r(9679);t.p2ms=n.p2ms;let s=r(27295);t.p2pk=s.p2pk;let u=r(97706);t.p2pkh=u.p2pkh;let o=r(57199);t.p2sh=o.p2sh;let a=r(27802);t.p2wpkh=a.p2wpkh;let p=r(3499);t.p2wsh=p.p2wsh},97570:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prop=function(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let e=r.call(this);return this[t]=e,e},set(e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})}})},t.value=function(e){let t;return()=>void 0!==t?t:t=e()}},9679:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(88909),n=r(48644),s=r(97570),u=n.OPS,o=r(71764),a=r(99390),p=u.OP_RESERVED;function c(e,t){return e.length===t.length&&e.every((e,r)=>e.equals(t[r]))}t.p2ms=function(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&void 0!==e.m)&&!e.signatures)throw TypeError("Not enough data");function r(e){return n.isCanonicalScriptSignature(e)||(t.allowIncomplete&&e===u.OP_0)!==void 0}t=Object.assign({validate:!0},t||{}),o({network:o.maybe(o.Object),m:o.maybe(o.Number),n:o.maybe(o.Number),output:o.maybe(o.Buffer),pubkeys:o.maybe(o.arrayOf(a.isPoint)),signatures:o.maybe(o.arrayOf(r)),input:o.maybe(o.Buffer)},e);let l=e.network||i.bitcoin,h={network:l},f=[],d=!1;function y(e){d||(d=!0,f=n.decompile(e),h.m=f[0]-p,h.n=f[f.length-2]-p,h.pubkeys=f.slice(1,-2))}if(s.prop(h,"output",()=>{if(e.m&&h.n&&e.pubkeys)return n.compile([].concat(p+e.m,e.pubkeys,p+h.n,u.OP_CHECKMULTISIG))}),s.prop(h,"m",()=>{if(h.output)return y(h.output),h.m}),s.prop(h,"n",()=>{if(h.pubkeys)return h.pubkeys.length}),s.prop(h,"pubkeys",()=>{if(e.output)return y(e.output),h.pubkeys}),s.prop(h,"signatures",()=>{if(e.input)return n.decompile(e.input).slice(1)}),s.prop(h,"input",()=>{if(e.signatures)return n.compile([u.OP_0].concat(e.signatures))}),s.prop(h,"witness",()=>{if(h.input)return[]}),s.prop(h,"name",()=>{if(h.m&&h.n)return`p2ms(${h.m} of ${h.n})`}),t.validate){if(e.output){if(y(e.output),!o.Number(f[0])||!o.Number(f[f.length-2])||f[f.length-1]!==u.OP_CHECKMULTISIG||h.m<=0||h.n>16||h.m>h.n||h.n!==f.length-3||!h.pubkeys.every(e=>a.isPoint(e)))throw TypeError("Output is invalid");if(void 0!==e.m&&e.m!==h.m)throw TypeError("m mismatch");if(void 0!==e.n&&e.n!==h.n)throw TypeError("n mismatch");if(e.pubkeys&&!c(e.pubkeys,h.pubkeys))throw TypeError("Pubkeys mismatch")}if(e.pubkeys){if(void 0!==e.n&&e.n!==e.pubkeys.length)throw TypeError("Pubkey count mismatch");if(h.n=e.pubkeys.length,h.n<h.m)throw TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<h.m)throw TypeError("Not enough signatures provided");if(e.signatures.length>h.m)throw TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==u.OP_0)throw TypeError("Input is invalid");if(0===h.signatures.length||!h.signatures.every(r))throw TypeError("Input has invalid signature(s)");if(e.signatures&&!c(e.signatures,h.signatures))throw TypeError("Signature mismatch");if(void 0!==e.m&&e.m!==e.signatures.length)throw TypeError("Signature count mismatch")}}return Object.assign(h,e)}},27295:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(88909),n=r(48644),s=r(97570),u=r(71764),o=n.OPS,a=r(99390);t.p2pk=function(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),u({network:u.maybe(u.Object),output:u.maybe(u.Buffer),pubkey:u.maybe(a.isPoint),signature:u.maybe(n.isCanonicalScriptSignature),input:u.maybe(u.Buffer)},e);let r=s.value(()=>n.decompile(e.input)),p=e.network||i.bitcoin,c={name:"p2pk",network:p};if(s.prop(c,"output",()=>{if(e.pubkey)return n.compile([e.pubkey,o.OP_CHECKSIG])}),s.prop(c,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),s.prop(c,"signature",()=>{if(e.input)return r()[0]}),s.prop(c,"input",()=>{if(e.signature)return n.compile([e.signature])}),s.prop(c,"witness",()=>{if(c.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==o.OP_CHECKSIG)throw TypeError("Output is invalid");if(!a.isPoint(c.pubkey))throw TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(c.pubkey))throw TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(c.input))throw TypeError("Signature mismatch");if(e.input){if(1!==r().length)throw TypeError("Input is invalid");if(!n.isCanonicalScriptSignature(c.signature))throw TypeError("Input has invalid signature")}}return Object.assign(c,e)}},97706:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(66432),s=r(88909),u=r(48644),o=r(97570),a=r(71764),p=u.OPS,c=r(99390),l=r(87484);t.p2pkh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({network:a.maybe(a.Object),address:a.maybe(a.String),hash:a.maybe(a.BufferN(20)),output:a.maybe(a.BufferN(25)),pubkey:a.maybe(c.isPoint),signature:a.maybe(u.isCanonicalScriptSignature),input:a.maybe(a.Buffer)},e);let r=o.value(()=>{let t=l.decode(e.address),r=t.readUInt8(0),i=t.slice(1);return{version:r,hash:i}}),h=o.value(()=>u.decompile(e.input)),f=e.network||s.bitcoin,d={name:"p2pkh",network:f};if(o.prop(d,"address",()=>{if(!d.hash)return;let e=i.allocUnsafe(21);return e.writeUInt8(f.pubKeyHash,0),d.hash.copy(e,1),l.encode(e)}),o.prop(d,"hash",()=>e.output?e.output.slice(3,23):e.address?r().hash:e.pubkey||d.pubkey?n.hash160(e.pubkey||d.pubkey):void 0),o.prop(d,"output",()=>{if(d.hash)return u.compile([p.OP_DUP,p.OP_HASH160,d.hash,p.OP_EQUALVERIFY,p.OP_CHECKSIG])}),o.prop(d,"pubkey",()=>{if(e.input)return h()[1]}),o.prop(d,"signature",()=>{if(e.input)return h()[0]}),o.prop(d,"input",()=>{if(e.pubkey&&e.signature)return u.compile([e.signature,e.pubkey])}),o.prop(d,"witness",()=>{if(d.input)return[]}),t.validate){let t=i.from([]);if(e.address){if(r().version!==f.pubKeyHash)throw TypeError("Invalid version or Network mismatch");if(20!==r().hash.length)throw TypeError("Invalid address");t=r().hash}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw TypeError("Hash mismatch");t=e.hash}if(e.output){if(25!==e.output.length||e.output[0]!==p.OP_DUP||e.output[1]!==p.OP_HASH160||20!==e.output[2]||e.output[23]!==p.OP_EQUALVERIFY||e.output[24]!==p.OP_CHECKSIG)throw TypeError("Output is invalid");let r=e.output.slice(3,23);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch");t=r}if(e.pubkey){let r=n.hash160(e.pubkey);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch");t=r}if(e.input){let r=h();if(2!==r.length)throw TypeError("Input is invalid");if(!u.isCanonicalScriptSignature(r[0]))throw TypeError("Input has invalid signature");if(!c.isPoint(r[1]))throw TypeError("Input has invalid pubkey");if(e.signature&&!e.signature.equals(r[0]))throw TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(r[1]))throw TypeError("Pubkey mismatch");let i=n.hash160(r[1]);if(t.length>0&&!t.equals(i))throw TypeError("Hash mismatch")}}return Object.assign(d,e)}},57199:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(66432),s=r(88909),u=r(48644),o=r(97570),a=r(71764),p=u.OPS,c=r(87484);t.p2sh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({network:a.maybe(a.Object),address:a.maybe(a.String),hash:a.maybe(a.BufferN(20)),output:a.maybe(a.BufferN(23)),redeem:a.maybe({network:a.maybe(a.Object),output:a.maybe(a.Buffer),input:a.maybe(a.Buffer),witness:a.maybe(a.arrayOf(a.Buffer))}),input:a.maybe(a.Buffer),witness:a.maybe(a.arrayOf(a.Buffer))},e);let r=e.network;r||(r=e.redeem&&e.redeem.network||s.bitcoin);let l={network:r},h=o.value(()=>{let t=c.decode(e.address),r=t.readUInt8(0),i=t.slice(1);return{version:r,hash:i}}),f=o.value(()=>u.decompile(e.input)),d=o.value(()=>{let t=f();return{network:r,output:t[t.length-1],input:u.compile(t.slice(0,-1)),witness:e.witness||[]}});if(o.prop(l,"address",()=>{if(!l.hash)return;let e=i.allocUnsafe(21);return e.writeUInt8(l.network.scriptHash,0),l.hash.copy(e,1),c.encode(e)}),o.prop(l,"hash",()=>e.output?e.output.slice(2,22):e.address?h().hash:l.redeem&&l.redeem.output?n.hash160(l.redeem.output):void 0),o.prop(l,"output",()=>{if(l.hash)return u.compile([p.OP_HASH160,l.hash,p.OP_EQUAL])}),o.prop(l,"redeem",()=>{if(e.input)return d()}),o.prop(l,"input",()=>{if(e.redeem&&e.redeem.input&&e.redeem.output)return u.compile([].concat(u.decompile(e.redeem.input),e.redeem.output))}),o.prop(l,"witness",()=>l.redeem&&l.redeem.witness?l.redeem.witness:l.input?[]:void 0),o.prop(l,"name",()=>{let e=["p2sh"];return void 0!==l.redeem&&e.push(l.redeem.name),e.join("-")}),t.validate){let t=i.from([]);if(e.address){if(h().version!==r.scriptHash)throw TypeError("Invalid version or Network mismatch");if(20!==h().hash.length)throw TypeError("Invalid address");t=h().hash}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw TypeError("Hash mismatch");t=e.hash}if(e.output){if(23!==e.output.length||e.output[0]!==p.OP_HASH160||20!==e.output[1]||e.output[22]!==p.OP_EQUAL)throw TypeError("Output is invalid");let r=e.output.slice(2,22);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch");t=r}let s=e=>{if(e.output){let r=u.decompile(e.output);if(!r||r.length<1)throw TypeError("Redeem.output too short");let i=n.hash160(e.output);if(t.length>0&&!t.equals(i))throw TypeError("Hash mismatch");t=i}if(e.input){let t=e.input.length>0,r=e.witness&&e.witness.length>0;if(!t&&!r)throw TypeError("Empty input");if(t&&r)throw TypeError("Input and witness provided");if(t){let t=u.decompile(e.input);if(!u.isPushOnly(t))throw TypeError("Non push-only scriptSig")}}};if(e.input){let e=f();if(!e||e.length<1)throw TypeError("Input too short");if(!i.isBuffer(d().output))throw TypeError("Input is invalid");s(d())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==r)throw TypeError("Network mismatch");if(e.input){let t=d();if(e.redeem.output&&!e.redeem.output.equals(t.output))throw TypeError("Redeem.output mismatch");if(e.redeem.input&&!e.redeem.input.equals(t.input))throw TypeError("Redeem.input mismatch")}s(e.redeem)}if(e.witness){var y,g;if(e.redeem&&e.redeem.witness&&(y=e.redeem.witness,g=e.witness,!(y.length===g.length&&y.every((e,t)=>e.equals(g[t])))))throw TypeError("Witness and redeem.witness mismatch")}}return Object.assign(l,e)}},27802:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(66432),s=r(88909),u=r(48644),o=r(97570),a=r(71764),p=u.OPS,c=r(99390),l=r(91004),h=i.alloc(0);t.p2wpkh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({address:a.maybe(a.String),hash:a.maybe(a.BufferN(20)),input:a.maybe(a.BufferN(0)),network:a.maybe(a.Object),output:a.maybe(a.BufferN(22)),pubkey:a.maybe(c.isPoint),signature:a.maybe(u.isCanonicalScriptSignature),witness:a.maybe(a.arrayOf(a.Buffer))},e);let r=o.value(()=>{let t=l.decode(e.address),r=t.words.shift(),n=l.fromWords(t.words);return{version:r,prefix:t.prefix,data:i.from(n)}}),f=e.network||s.bitcoin,d={name:"p2wpkh",network:f};if(o.prop(d,"address",()=>{if(!d.hash)return;let e=l.toWords(d.hash);return e.unshift(0),l.encode(f.bech32,e)}),o.prop(d,"hash",()=>e.output?e.output.slice(2,22):e.address?r().data:e.pubkey||d.pubkey?n.hash160(e.pubkey||d.pubkey):void 0),o.prop(d,"output",()=>{if(d.hash)return u.compile([p.OP_0,d.hash])}),o.prop(d,"pubkey",()=>e.pubkey?e.pubkey:e.witness?e.witness[1]:void 0),o.prop(d,"signature",()=>{if(e.witness)return e.witness[0]}),o.prop(d,"input",()=>{if(d.witness)return h}),o.prop(d,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let t=i.from([]);if(e.address){if(f&&f.bech32!==r().prefix)throw TypeError("Invalid prefix or Network mismatch");if(0!==r().version)throw TypeError("Invalid address version");if(20!==r().data.length)throw TypeError("Invalid address data");t=r().data}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw TypeError("Hash mismatch");t=e.hash}if(e.output){if(22!==e.output.length||e.output[0]!==p.OP_0||20!==e.output[1])throw TypeError("Output is invalid");if(t.length>0&&!t.equals(e.output.slice(2)))throw TypeError("Hash mismatch");t=e.output.slice(2)}if(e.pubkey){let r=n.hash160(e.pubkey);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch");if(t=r,!c.isPoint(e.pubkey)||33!==e.pubkey.length)throw TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(2!==e.witness.length)throw TypeError("Witness is invalid");if(!u.isCanonicalScriptSignature(e.witness[0]))throw TypeError("Witness has invalid signature");if(!c.isPoint(e.witness[1])||33!==e.witness[1].length)throw TypeError("Witness has invalid pubkey");if(e.signature&&!e.signature.equals(e.witness[0]))throw TypeError("Signature mismatch");if(e.pubkey&&!e.pubkey.equals(e.witness[1]))throw TypeError("Pubkey mismatch");let r=n.hash160(e.witness[1]);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch")}}return Object.assign(d,e)}},3499:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(66432),s=r(88909),u=r(48644),o=r(97570),a=r(71764),p=u.OPS,c=r(99390),l=r(91004),h=i.alloc(0);function f(e){return!!(i.isBuffer(e)&&65===e.length&&4===e[0]&&c.isPoint(e))}t.p2wsh=function(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),a({network:a.maybe(a.Object),address:a.maybe(a.String),hash:a.maybe(a.BufferN(32)),output:a.maybe(a.BufferN(34)),redeem:a.maybe({input:a.maybe(a.Buffer),network:a.maybe(a.Object),output:a.maybe(a.Buffer),witness:a.maybe(a.arrayOf(a.Buffer))}),input:a.maybe(a.BufferN(0)),witness:a.maybe(a.arrayOf(a.Buffer))},e);let r=o.value(()=>{let t=l.decode(e.address),r=t.words.shift(),n=l.fromWords(t.words);return{version:r,prefix:t.prefix,data:i.from(n)}}),c=o.value(()=>u.decompile(e.redeem.input)),d=e.network;d||(d=e.redeem&&e.redeem.network||s.bitcoin);let y={network:d};if(o.prop(y,"address",()=>{if(!y.hash)return;let e=l.toWords(y.hash);return e.unshift(0),l.encode(d.bech32,e)}),o.prop(y,"hash",()=>e.output?e.output.slice(2):e.address?r().data:y.redeem&&y.redeem.output?n.sha256(y.redeem.output):void 0),o.prop(y,"output",()=>{if(y.hash)return u.compile([p.OP_0,y.hash])}),o.prop(y,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:h,witness:e.witness.slice(0,-1)}}),o.prop(y,"input",()=>{if(y.witness)return h}),o.prop(y,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){let t=u.toStack(c());return y.redeem=Object.assign({witness:t},e.redeem),y.redeem.input=h,[].concat(t,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),o.prop(y,"name",()=>{let e=["p2wsh"];return void 0!==y.redeem&&e.push(y.redeem.name),e.join("-")}),t.validate){let t=i.from([]);if(e.address){if(r().prefix!==d.bech32)throw TypeError("Invalid prefix or Network mismatch");if(0!==r().version)throw TypeError("Invalid address version");if(32!==r().data.length)throw TypeError("Invalid address data");t=r().data}if(e.hash){if(t.length>0&&!t.equals(e.hash))throw TypeError("Hash mismatch");t=e.hash}if(e.output){if(34!==e.output.length||e.output[0]!==p.OP_0||32!==e.output[1])throw TypeError("Output is invalid");let r=e.output.slice(2);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch");t=r}if(e.redeem){var g,m;if(e.redeem.network&&e.redeem.network!==d)throw TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw TypeError("Ambiguous witness source");if(e.redeem.output){if(0===u.decompile(e.redeem.output).length)throw TypeError("Redeem.output is invalid");let r=n.sha256(e.redeem.output);if(t.length>0&&!t.equals(r))throw TypeError("Hash mismatch");t=r}if(e.redeem.input&&!u.isPushOnly(c()))throw TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&(g=e.witness,m=e.redeem.witness,!(g.length===m.length&&g.every((e,t)=>e.equals(m[t])))))throw TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&c().some(f)||e.redeem.output&&(u.decompile(e.redeem.output)||[]).some(f))throw TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){let t=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&!e.redeem.output.equals(t))throw TypeError("Witness and redeem.output mismatch");if(e.witness.some(f)||(u.decompile(t)||[]).some(f))throw TypeError("Witness contains uncompressed pubkey")}}return Object.assign(y,e)}},78700:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(51124),s=r(30941),u=r(70988),o=r(78305),a=r(54372),p=r(66432),c=r(6091),l=r(88909),h=r(76109),f=r(48644),d=r(92789),y={network:l.bitcoin,maximumFeeRate:5e3};class g{constructor(e={},t=new n.Psbt(new _)){this.data=t,this.opts=Object.assign({},y,e),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);let r=(e,t,r,i)=>Object.defineProperty(e,t,{enumerable:r,writable:i});r(this,"__CACHE",!1,!0),r(this,"opts",!1,!0)}static fromBase64(e,t={}){let r=i.from(e,"base64");return this.fromBuffer(r,t)}static fromHex(e,t={}){let r=i.from(e,"hex");return this.fromBuffer(r,t)}static fromBuffer(e,t={}){let r=n.Psbt.fromBuffer(e,m),i=new g(t,r);return function(e,t){e.ins.forEach(e=>{C(t,e)})}(i.__CACHE.__TX,i.__CACHE),i}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(e){this.setVersion(e)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(e){this.setLocktime(e)}get txInputs(){return this.__CACHE.__TX.ins.map(e=>({hash:a.cloneBuffer(e.hash),index:e.index,sequence:e.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(e=>{let t;try{t=o.fromOutputScript(e.script,this.opts.network)}catch(e){}return{script:a.cloneBuffer(e.script),value:e.value,address:t}})}combine(...e){return this.data.combine(...e.map(e=>e.data)),this}clone(){let e=g.fromBuffer(this.data.toBuffer());return e.opts=JSON.parse(JSON.stringify(this.opts)),e}setMaximumFeeRate(e){A(e),this.opts.maximumFeeRate=e}setVersion(e){A(e),U(this.data.inputs,"setVersion");let t=this.__CACHE;return t.__TX.version=e,t.__EXTRACTED_TX=void 0,this}setLocktime(e){A(e),U(this.data.inputs,"setLocktime");let t=this.__CACHE;return t.__TX.locktime=e,t.__EXTRACTED_TX=void 0,this}setInputSequence(e,t){A(t),U(this.data.inputs,"setInputSequence");let r=this.__CACHE;if(r.__TX.ins.length<=e)throw Error("Input index too high");return r.__TX.ins[e].sequence=t,r.__EXTRACTED_TX=void 0,this}addInputs(e){return e.forEach(e=>this.addInput(e)),this}addInput(e){if(arguments.length>1||!e||void 0===e.hash||void 0===e.index)throw Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");U(this.data.inputs,"addInput"),e.witnessScript&&z(e.witnessScript);let t=this.__CACHE;this.data.addInput(e);let r=t.__TX.ins[t.__TX.ins.length-1];C(t,r);let i=this.data.inputs.length-1,n=this.data.inputs[i];return n.nonWitnessUtxo&&G(this.__CACHE,n,i),t.__FEE=void 0,t.__FEE_RATE=void 0,t.__EXTRACTED_TX=void 0,this}addOutputs(e){return e.forEach(e=>this.addOutput(e)),this}addOutput(e){if(arguments.length>1||!e||void 0===e.value||void 0===e.address&&void 0===e.script)throw Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");U(this.data.inputs,"addOutput");let{address:t}=e;if("string"==typeof t){let{network:r}=this.opts,i=o.toOutputScript(t,r);e=Object.assign(e,{script:i})}let r=this.__CACHE;return this.data.addOutput(e),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}extractTransaction(e){if(!this.data.inputs.every(E))throw Error("Not finalized");let t=this.__CACHE;if(e||function(e,t,r){let i=t.__FEE_RATE||e.getFeeRate(),n=t.__EXTRACTED_TX.virtualSize();if(i>=r.maximumFeeRate)throw Error(`Warning: You are paying around ${(i*n/1e8).toFixed(8)} in fees, which is ${i} satoshi per byte for a transaction with a VSize of ${n} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,t,this.opts),t.__EXTRACTED_TX)return t.__EXTRACTED_TX;let r=t.__TX.clone();return j(this.data.inputs,r,t,!0),r}getFeeRate(){return L("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return L("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return u.checkForInput(this.data.inputs,0),Z(this.data.inputs.length).forEach(e=>this.finalizeInput(e)),this}finalizeInput(e,t=D){let r=u.checkForInput(this.data.inputs,e),{script:i,isP2SH:n,isP2WSH:s,isSegwit:o}=function(e,t,r){let i=r.__TX,n={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(n.isP2SH=!!t.redeemScript,n.isP2WSH=!!t.witnessScript,t.witnessScript)n.script=t.witnessScript;else if(t.redeemScript)n.script=t.redeemScript;else if(t.nonWitnessUtxo){let s=X(r,t,e),u=i.ins[e].index;n.script=s.outs[u].script}else t.witnessUtxo&&(n.script=t.witnessUtxo.script);return(t.witnessScript||P(n.script))&&(n.isSegwit=!0),n}(e,r,this.__CACHE);if(!i)throw Error(`No script found for input #${e}`);!function(e){if(!e.sighashType||!e.partialSig)return;let{partialSig:t,sighashType:r}=e;t.forEach(e=>{let{hashType:t}=f.signature.decode(e.signature);if(r!==t)throw Error("Signature sighash does not match input sighash type")})}(r);let{finalScriptSig:a,finalScriptWitness:p}=t(e,r,i,o,n,s);if(a&&this.data.updateInput(e,{finalScriptSig:a}),p&&this.data.updateInput(e,{finalScriptWitness:p}),!a&&!p)throw Error(`Unknown error finalizing input #${e}`);return this.data.clearFinalizedInput(e),this}getInputType(e){let t=u.checkForInput(this.data.inputs,e),r=q(e,t,this.__CACHE),n=Y(r,e,"input",t.redeemScript||function(e){if(!e)return;let t=f.decompile(e);if(!t)return;let r=t[t.length-1];if(!i.isBuffer(r)||$(r)||f.isCanonicalScriptSignature(r))return;let n=f.decompile(r);if(n)return r}(t.finalScriptSig),t.witnessScript||function(e){if(!e)return;let t=V(e),r=t[t.length-1];if($(r))return;let i=f.decompile(r);if(i)return r}(t.finalScriptWitness)),s="raw"===n.type?"":n.type+"-",o=J(n.meaningfulScript);return s+o}inputHasPubkey(e,t){let r=u.checkForInput(this.data.inputs,e);return function(e,t,r,i){let n=q(r,t,i),{meaningfulScript:s}=Y(n,r,"input",t.redeemScript,t.witnessScript);return Q(e,s)}(t,r,e,this.__CACHE)}inputHasHDKey(e,t){let r=u.checkForInput(this.data.inputs,e),i=N(t);return!!r.bip32Derivation&&r.bip32Derivation.some(i)}outputHasPubkey(e,t){let r=u.checkForOutput(this.data.outputs,e);return function(e,t,r,i){let n=i.__TX.outs[r].script,{meaningfulScript:s}=Y(n,r,"output",t.redeemScript,t.witnessScript);return Q(e,s)}(t,r,e,this.__CACHE)}outputHasHDKey(e,t){let r=u.checkForOutput(this.data.outputs,e),i=N(t);return!!r.bip32Derivation&&r.bip32Derivation.some(i)}validateSignaturesOfAllInputs(){u.checkForInput(this.data.inputs,0);let e=Z(this.data.inputs.length).map(e=>this.validateSignaturesOfInput(e));return e.reduce((e,t)=>!0===t&&e,!0)}validateSignaturesOfInput(e,t){let r,i,n;let s=this.data.inputs[e],u=(s||{}).partialSig;if(!s||!u||u.length<1)throw Error("No signatures to validate");let o=t?u.filter(e=>e.pubkey.equals(t)):u;if(o.length<1)throw Error("No signatures for this pubkey");let a=[];for(let t of o){let u=f.signature.decode(t.signature),{hash:o,script:p}=n!==u.hashType?W(e,Object.assign({},s,{sighashType:u.hashType}),this.__CACHE,!0):{hash:r,script:i};n=u.hashType,r=o,i=p,H(t.pubkey,p,"verify");let l=c.fromPublicKey(t.pubkey);a.push(l.verify(o,u.signature))}return a.every(e=>!0===e)}signAllInputsHD(e,t=[d.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint)throw Error("Need HDSigner to sign input");let r=[];for(let i of Z(this.data.inputs.length))try{this.signInputHD(i,e,t),r.push(!0)}catch(e){r.push(!1)}if(r.every(e=>!1===e))throw Error("No inputs were signed");return this}signAllInputsHDAsync(e,t=[d.Transaction.SIGHASH_ALL]){return new Promise((r,i)=>{if(!e||!e.publicKey||!e.fingerprint)return i(Error("Need HDSigner to sign input"));let n=[],s=[];for(let r of Z(this.data.inputs.length))s.push(this.signInputHDAsync(r,e,t).then(()=>{n.push(!0)},()=>{n.push(!1)}));return Promise.all(s).then(()=>{if(n.every(e=>!1===e))return i(Error("No inputs were signed"));r()})})}signInputHD(e,t,r=[d.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw Error("Need HDSigner to sign input");let i=M(e,this.data.inputs,t);return i.forEach(t=>this.signInput(e,t,r)),this}signInputHDAsync(e,t,r=[d.Transaction.SIGHASH_ALL]){return new Promise((i,n)=>{if(!t||!t.publicKey||!t.fingerprint)return n(Error("Need HDSigner to sign input"));let s=M(e,this.data.inputs,t),u=s.map(t=>this.signInputAsync(e,t,r));return Promise.all(u).then(()=>{i()}).catch(n)})}signAllInputs(e,t=[d.Transaction.SIGHASH_ALL]){if(!e||!e.publicKey)throw Error("Need Signer to sign input");let r=[];for(let i of Z(this.data.inputs.length))try{this.signInput(i,e,t),r.push(!0)}catch(e){r.push(!1)}if(r.every(e=>!1===e))throw Error("No inputs were signed");return this}signAllInputsAsync(e,t=[d.Transaction.SIGHASH_ALL]){return new Promise((r,i)=>{if(!e||!e.publicKey)return i(Error("Need Signer to sign input"));let n=[],s=[];for(let[r]of this.data.inputs.entries())s.push(this.signInputAsync(r,e,t).then(()=>{n.push(!0)},()=>{n.push(!1)}));return Promise.all(s).then(()=>{if(n.every(e=>!1===e))return i(Error("No inputs were signed"));r()})})}signInput(e,t,r=[d.Transaction.SIGHASH_ALL]){if(!t||!t.publicKey)throw Error("Need Signer to sign input");let{hash:i,sighashType:n}=K(this.data.inputs,e,t.publicKey,this.__CACHE,r),s=[{pubkey:t.publicKey,signature:f.signature.encode(t.sign(i),n)}];return this.data.updateInput(e,{partialSig:s}),this}signInputAsync(e,t,r=[d.Transaction.SIGHASH_ALL]){return Promise.resolve().then(()=>{if(!t||!t.publicKey)throw Error("Need Signer to sign input");let{hash:i,sighashType:n}=K(this.data.inputs,e,t.publicKey,this.__CACHE,r);return Promise.resolve(t.sign(i)).then(r=>{let i=[{pubkey:t.publicKey,signature:f.signature.encode(r,n)}];this.data.updateInput(e,{partialSig:i})})})}toBuffer(){return S(this.__CACHE),this.data.toBuffer()}toHex(){return S(this.__CACHE),this.data.toHex()}toBase64(){return S(this.__CACHE),this.data.toBase64()}updateGlobal(e){return this.data.updateGlobal(e),this}updateInput(e,t){return t.witnessScript&&z(t.witnessScript),this.data.updateInput(e,t),t.nonWitnessUtxo&&G(this.__CACHE,this.data.inputs[e],e),this}updateOutput(e,t){return this.data.updateOutput(e,t),this}addUnknownKeyValToGlobal(e){return this.data.addUnknownKeyValToGlobal(e),this}addUnknownKeyValToInput(e,t){return this.data.addUnknownKeyValToInput(e,t),this}addUnknownKeyValToOutput(e,t){return this.data.addUnknownKeyValToOutput(e,t),this}clearFinalizedInput(e){return this.data.clearFinalizedInput(e),this}}t.Psbt=g;let m=e=>new _(e);class _{constructor(e=i.from([2,0,0,0,0,0,0,0,0,0])){this.tx=d.Transaction.fromBuffer(e),function(e){let t=e.ins.every(e=>e.script&&0===e.script.length&&e.witness&&0===e.witness.length);if(!t)throw Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(e){if(void 0===e.hash||void 0===e.index||!i.isBuffer(e.hash)&&"string"!=typeof e.hash||"number"!=typeof e.index)throw Error("Error adding input.");let t="string"==typeof e.hash?a.reverseBuffer(i.from(e.hash,"hex")):e.hash;this.tx.addInput(t,e.index,e.sequence)}addOutput(e){if(void 0===e.script||void 0===e.value||!i.isBuffer(e.script)||"number"!=typeof e.value)throw Error("Error adding output.");this.tx.addOutput(e.script,e.value)}toBuffer(){return this.tx.toBuffer()}}function S(e){if(!1!==e.__UNSAFE_SIGN_NONSEGWIT)throw Error("Not BIP174 compliant, can not export")}function w(e,t,r){let i;if(!t)return!1;if((i=r?r.map(e=>{let r=c.fromPublicKey(e,{compressed:!0}).publicKey;return t.find(e=>e.pubkey.equals(r))}).filter(e=>!!e):t).length>e)throw Error("Too many signatures");return i.length===e}function E(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function b(e){return t=>{try{return e({output:t}),!0}catch(e){return!1}}}let v=b(h.p2ms),T=b(h.p2pk),O=b(h.p2pkh),P=b(h.p2wpkh),I=b(h.p2wsh),k=b(h.p2sh);function N(e){return t=>!!(t.masterFingerprint.equals(e.fingerprint)&&e.derivePath(t.path).publicKey.equals(t.pubkey))}function A(e){if("number"!=typeof e||e!==Math.floor(e)||e>4294967295||e<0)throw Error("Invalid 32 bit integer")}function U(e,t){e.forEach(e=>{let r=!1,n=[];if(0===(e.partialSig||[]).length){if(!e.finalScriptSig&&!e.finalScriptWitness)return;n=function(e){let t=e.finalScriptSig&&f.decompile(e.finalScriptSig)||[],r=e.finalScriptWitness&&f.decompile(e.finalScriptWitness)||[];return t.concat(r).filter(e=>i.isBuffer(e)&&f.isCanonicalScriptSignature(e)).map(e=>({signature:e}))}(e)}else n=e.partialSig;if(n.forEach(e=>{let{hashType:i}=f.signature.decode(e.signature),n=[],s=i&d.Transaction.SIGHASH_ANYONECANPAY;switch(s&&n.push("addInput"),31&i){case d.Transaction.SIGHASH_ALL:break;case d.Transaction.SIGHASH_SINGLE:case d.Transaction.SIGHASH_NONE:n.push("addOutput"),n.push("setInputSequence")}-1===n.indexOf(t)&&(r=!0)}),r)throw Error("Can not modify transaction, signatures exist.")})}function H(e,t,r){if(!Q(e,t))throw Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function C(e,t){let r=a.reverseBuffer(i.from(t.hash)).toString("hex")+":"+t.index;if(e.__TX_IN_CACHE[r])throw Error("Duplicate input detected.");e.__TX_IN_CACHE[r]=1}function B(e,t){return(r,i,n,s)=>{let u=e({redeem:{output:n}}).output;if(!i.equals(u))throw Error(`${t} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}let x=B(h.p2sh,"Redeem script"),R=B(h.p2wsh,"Witness script");function L(e,t,r,i){let n;if(!r.every(E))throw Error(`PSBT must be finalized to calculate ${t}`);if("__FEE_RATE"===e&&i.__FEE_RATE)return i.__FEE_RATE;if("__FEE"===e&&i.__FEE)return i.__FEE;let s=!0;return(i.__EXTRACTED_TX?(n=i.__EXTRACTED_TX,s=!1):n=i.__TX.clone(),j(r,n,i,s),"__FEE_RATE"===e)?i.__FEE_RATE:"__FEE"===e?i.__FEE:void 0}function D(e,t,r,i,n,s){let u=J(r);if(!function(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return w(1,e.partialSig);case"multisig":let i=h.p2ms({output:t});return w(i.m,e.partialSig,i.pubkeys);default:return!1}}(t,r,u))throw Error(`Can not finalize input #${e}`);return function(e,t,r,i,n,s){let u,o;let a=function(e,t,r){let i;switch(t){case"multisig":let n=function(e,t){let r=h.p2ms({output:e});return r.pubkeys.map(e=>(t.filter(t=>t.pubkey.equals(e))[0]||{}).signature).filter(e=>!!e)}(e,r);i=h.p2ms({output:e,signatures:n});break;case"pubkey":i=h.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":i=h.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":i=h.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature})}return i}(e,t,r),p=s?h.p2wsh({redeem:a}):null,c=n?h.p2sh({redeem:p||a}):null;return i?(o=p?F(p.witness):F(a.witness),c&&(u=c.input)):u=c?c.input:a.input,{finalScriptSig:u,finalScriptWitness:o}}(r,u,t.partialSig,i,n,s)}function K(e,t,r,i,n){let s=u.checkForInput(e,t),{hash:o,sighashType:a,script:p}=W(t,s,i,!1,n);return H(r,p,"sign"),{hash:o,sighashType:a}}function W(e,t,r,i,n){let s,u;let o=r.__TX,a=t.sighashType||d.Transaction.SIGHASH_ALL;if(n&&0>n.indexOf(a)){let e=function(e){let t=e&d.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(31&e){case d.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case d.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case d.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE"}return t}(a);throw Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${e}`)}if(t.nonWitnessUtxo){let i=X(r,t,e),n=o.ins[e].hash,s=i.getHash();if(!n.equals(s))throw Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);let a=o.ins[e].index;u=i.outs[a]}else if(t.witnessUtxo)u=t.witnessUtxo;else throw Error("Need a Utxo input item for signing");let{meaningfulScript:p,type:c}=Y(u.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(c)>=0)s=o.hashForWitnessV0(e,p,u.value,a);else if(P(p)){let t=h.p2pkh({hash:p.slice(2)}).output;s=o.hashForWitnessV0(e,t,u.value,a)}else{if(void 0===t.nonWitnessUtxo&&!1===r.__UNSAFE_SIGN_NONSEGWIT)throw Error(`Input #${e} has witnessUtxo but non-segwit script: ${p.toString("hex")}`);i||!1===r.__UNSAFE_SIGN_NONSEGWIT||console.warn("Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as the old TransactionBuilder class when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.\n*********************\nPROCEED WITH CAUTION!\n*********************"),s=o.hashForSignature(e,p,a)}return{script:p,sighashType:a,hash:s}}function M(e,t,r){let i=u.checkForInput(t,e);if(!i.bip32Derivation||0===i.bip32Derivation.length)throw Error("Need bip32Derivation to sign with HD");let n=i.bip32Derivation.map(e=>e.masterFingerprint.equals(r.fingerprint)?e:void 0).filter(e=>!!e);if(0===n.length)throw Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");let s=n.map(e=>{let t=r.derivePath(e.path);if(!e.pubkey.equals(t.publicKey))throw Error("pubkey did not match bip32Derivation");return t});return s}function V(e){let t=0;function r(){let r=s.decode(e,t);return t+=s.decode.bytes,r}return function(){let i=r(),n=[];for(let s=0;s<i;s++)n.push(function(){var i;return i=r(),t+=i,e.slice(t-i,t)}());return n}()}function F(e){let t=i.allocUnsafe(0);function r(e){let r=t.length,n=s.encodingLength(e);t=i.concat([t,i.allocUnsafe(n)]),s.encode(e,t,r)}return r(e.length),e.forEach(function(e){r(e.length),t=i.concat([t,i.from(e)])}),t}function G(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;let i=d.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=i,delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){let t=e.__NON_WITNESS_UTXO_BUF_CACHE[r],i=e.__NON_WITNESS_UTXO_TX_CACHE[r];if(void 0!==t)return t;{let t=i.toBuffer();return e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t,t}},set(t){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t}})}function j(e,t,r,i){let n=0;e.forEach((e,s)=>{if(i&&e.finalScriptSig&&(t.ins[s].script=e.finalScriptSig),i&&e.finalScriptWitness&&(t.ins[s].witness=V(e.finalScriptWitness)),e.witnessUtxo)n+=e.witnessUtxo.value;else if(e.nonWitnessUtxo){let i=X(r,e,s),u=t.ins[s].index,o=i.outs[u];n+=o.value}});let s=t.outs.reduce((e,t)=>e+t.value,0),u=n-s;if(u<0)throw Error("Outputs are spending more than Inputs");let o=t.virtualSize();r.__FEE=u,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(u/o)}function X(e,t,r){let i=e.__NON_WITNESS_UTXO_TX_CACHE;return i[r]||G(e,t,r),i[r]}function q(e,t,r){if(void 0!==t.witnessUtxo)return t.witnessUtxo.script;if(void 0!==t.nonWitnessUtxo){let i=X(r,t,e);return i.outs[r.__TX.ins[e].index].script}throw Error("Can't find pubkey in input without Utxo data")}function $(e){return 33===e.length&&f.isCanonicalPubKey(e)}function Y(e,t,r,i,n){let s;let u=k(e),o=u&&i&&I(i),a=I(e);if(u&&void 0===i)throw Error("scriptPubkey is P2SH but redeemScript missing");if((a||o)&&void 0===n)throw Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");return o?(s=n,x(t,e,i,r),R(t,i,n,r),z(s)):a?(s=n,R(t,e,n,r),z(s)):u?(s=i,x(t,e,i,r)):s=e,{meaningfulScript:s,type:o?"p2sh-p2wsh":u?"p2sh":a?"p2wsh":"raw"}}function z(e){if(P(e)||k(e))throw Error("P2WPKH or P2SH can not be contained within P2WSH")}function Q(e,t){let r=p.hash160(e),i=f.decompile(t);if(null===i)throw Error("Unknown script error");return i.some(t=>"number"!=typeof t&&(t.equals(e)||t.equals(r)))}function J(e){return P(e)?"witnesspubkeyhash":O(e)?"pubkeyhash":v(e)?"multisig":T(e)?"pubkey":"nonstandard"}function Z(e){return[...Array(e).keys()]}},48644:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(7158),s=r(74773),u=r(11972),o=r(42679),a=r(99390),p=r(52043),c=r(71764);t.OPS=r(39991);let l=r(68221),h=t.OPS.OP_RESERVED;function f(e){return u.Buffer(e)||u.Number(e)&&(e===t.OPS.OP_0||e>=t.OPS.OP_1&&e<=t.OPS.OP_16||e===t.OPS.OP_1NEGATE)}function d(e){return u.Array(e)&&e.every(f)}function y(e){if(0===e.length)return t.OPS.OP_0;if(1===e.length){if(e[0]>=1&&e[0]<=16)return h+e[0];if(129===e[0])return t.OPS.OP_1NEGATE}}function g(e){return i.isBuffer(e)}function m(e){return i.isBuffer(e)}function _(e){if(g(e))return e;c(u.Array,e);let t=e.reduce((e,t)=>m(t)?1===t.length&&void 0!==y(t)?e+1:e+p.encodingLength(t.length)+t.length:e+1,0),r=i.allocUnsafe(t),n=0;if(e.forEach(e=>{if(m(e)){let t=y(e);if(void 0!==t){r.writeUInt8(t,n),n+=1;return}n+=p.encode(r,e.length,n),e.copy(r,n),n+=e.length}else r.writeUInt8(e,n),n+=1}),n!==r.length)throw Error("Could not decode chunks");return r}function S(e){if(u.Array(e))return e;c(u.Buffer,e);let r=[],i=0;for(;i<e.length;){let n=e[i];if(n>t.OPS.OP_0&&n<=t.OPS.OP_PUSHDATA4){let t=p.decode(e,i);if(null===t||(i+=t.size)+t.number>e.length)return null;let n=e.slice(i,i+t.number);i+=t.number;let s=y(n);void 0!==s?r.push(s):r.push(n)}else r.push(n),i+=1}return r}function w(e){let t=-129&e;return t>0&&t<4}t.isPushOnly=d,t.compile=_,t.decompile=S,t.toASM=function(e){return g(e)&&(e=S(e)),e.map(e=>{if(m(e)){let t=y(e);if(void 0===t)return e.toString("hex");e=t}return l[e]}).join(" ")},t.fromASM=function(e){return c(u.String,e),_(e.split(" ").map(e=>void 0!==t.OPS[e]?t.OPS[e]:(c(u.Hex,e),i.from(e,"hex"))))},t.toStack=function(e){return c(d,e=S(e)),e.map(e=>m(e)?e:e===t.OPS.OP_0?i.allocUnsafe(0):n.encode(e-h))},t.isCanonicalPubKey=function(e){return a.isPoint(e)},t.isDefinedHashType=w,t.isCanonicalScriptSignature=function(e){return!!(i.isBuffer(e)&&w(e[e.length-1]))&&o.check(e.slice(0,-1))},t.number=n,t.signature=s},7158:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.decode=function(e,t,r){t=t||4,r=void 0===r||r;let i=e.length;if(0===i)return 0;if(i>t)throw TypeError("Script number overflow");if(r&&(127&e[i-1])==0&&(i<=1||(128&e[i-2])==0))throw Error("Non-minimally encoded script number");if(5===i){let t=e.readUInt32LE(0),r=e.readUInt8(4);return 128&r?-((-129&r)*4294967296+t):4294967296*r+t}let n=0;for(let t=0;t<i;++t)n|=e[t]<<8*t;return 128&e[i-1]?-(n&~(128<<8*(i-1))):n},t.encode=function(e){var t;let r=Math.abs(e),n=(t=r)>2147483647?5:t>8388607?4:t>32767?3:t>127?2:t>0?1:0,s=i.allocUnsafe(n),u=e<0;for(let e=0;e<n;++e)s.writeUInt8(255&r,e),r>>=8;return 128&s[n-1]?s.writeUInt8(u?128:0,n-1):u&&(s[n-1]|=128),s}},74773:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(11972),s=r(42679),u=r(71764),o=i.alloc(1,0);function a(e){let t=0;for(;0===e[t];)++t;return t===e.length?o:128&(e=e.slice(t))[0]?i.concat([o,e],1+e.length):e}function p(e){0===e[0]&&(e=e.slice(1));let t=i.alloc(32,0),r=Math.max(0,32-e.length);return e.copy(t,r),t}t.decode=function(e){let t=e.readUInt8(e.length-1),r=-129&t;if(r<=0||r>=4)throw Error("Invalid hashType "+t);let n=s.decode(e.slice(0,-1)),u=p(n.r),o=p(n.s),a=i.concat([u,o],64);return{signature:a,hashType:t}},t.encode=function(e,t){u({signature:n.BufferN(64),hashType:n.UInt8},{signature:e,hashType:t});let r=-129&t;if(r<=0||r>=4)throw Error("Invalid hashType "+t);let o=i.allocUnsafe(1);o.writeUInt8(t,0);let p=a(e.slice(0,32)),c=a(e.slice(32,64));return i.concat([s.encode(p,c),o])}},91032:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(13793);t.input=i;let n=r(76134);t.output=n},13793:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644);function s(e){return e===n.OPS.OP_0||i.isCanonicalScriptSignature(e)}function u(e,t){let r=i.decompile(e);return!(r.length<2)&&r[0]===n.OPS.OP_0&&(t?r.slice(1).every(s):r.slice(1).every(i.isCanonicalScriptSignature))}t.check=u,u.toJSON=()=>"multisig input"},76134:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644),s=r(11972),u=n.OPS.OP_RESERVED;function o(e,t){let r=i.decompile(e);if(r.length<4||r[r.length-1]!==n.OPS.OP_CHECKMULTISIG||!s.Number(r[0])||!s.Number(r[r.length-2]))return!1;let o=r[0]-u,a=r[r.length-2]-u;if(o<=0||a>16||o>a||a!==r.length-3)return!1;if(t)return!0;let p=r.slice(1,-2);return p.every(i.isCanonicalPubKey)}t.check=o,o.toJSON=()=>"multi-sig output"},35939:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=i.OPS;function s(e){let t=i.compile(e);return t.length>1&&t[0]===n.OP_RETURN}t.check=s,s.toJSON=()=>"null data output",t.output={check:s}},93263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(70560);t.input=i;let n=r(58763);t.output=n},70560:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644);function n(e){let t=i.decompile(e);return 1===t.length&&i.isCanonicalScriptSignature(t[0])}t.check=n,n.toJSON=()=>"pubKey input"},58763:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644);function s(e){let t=i.decompile(e);return 2===t.length&&i.isCanonicalPubKey(t[0])&&t[1]===n.OPS.OP_CHECKSIG}t.check=s,s.toJSON=()=>"pubKey output"},13986:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(7857);t.input=i;let n=r(13339);t.output=n},7857:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644);function n(e){let t=i.decompile(e);return 2===t.length&&i.isCanonicalScriptSignature(t[0])&&i.isCanonicalPubKey(t[1])}t.check=n,n.toJSON=()=>"pubKeyHash input"},13339:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644);function s(e){let t=i.compile(e);return 25===t.length&&t[0]===n.OPS.OP_DUP&&t[1]===n.OPS.OP_HASH160&&20===t[2]&&t[23]===n.OPS.OP_EQUALVERIFY&&t[24]===n.OPS.OP_CHECKSIG}t.check=s,s.toJSON=()=>"pubKeyHash output"},64022:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(9095);t.input=i;let n=r(9534);t.output=n},9095:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(48644),s=r(91032),u=r(93263),o=r(13986),a=r(82189),p=r(12408);function c(e,t){let r=n.decompile(e);if(r.length<1)return!1;let c=r[r.length-1];if(!i.isBuffer(c))return!1;let l=n.decompile(n.compile(r.slice(0,-1))),h=n.decompile(c);return!!(h&&n.isPushOnly(l))&&(1===r.length?p.check(h)||a.check(h):!!(o.input.check(l)&&o.output.check(h)||s.input.check(l,t)&&s.output.check(h)||u.input.check(l)&&u.output.check(h)))}t.check=c,c.toJSON=()=>"scriptHash input"},9534:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644);function s(e){let t=i.compile(e);return 23===t.length&&t[0]===n.OPS.OP_HASH160&&20===t[1]&&t[22]===n.OPS.OP_EQUAL}t.check=s,s.toJSON=()=>"scriptHash output"},63925:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(21261);t.output=i},21261:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(48644),s=r(48644),u=r(11972),o=r(71764),a=i.from("aa21a9ed","hex");function p(e){let t=n.compile(e);return t.length>37&&t[0]===s.OPS.OP_RETURN&&36===t[1]&&t.slice(2,6).equals(a)}t.check=p,p.toJSON=()=>"Witness commitment output",t.encode=function(e){o(u.Hash256bit,e);let t=i.allocUnsafe(36);return a.copy(t,0),e.copy(t,4),n.compile([s.OPS.OP_RETURN,t])},t.decode=function(e){return o(p,e),n.decompile(e)[1].slice(4,36)}},76377:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(97676);t.input=i;let n=r(82189);t.output=n},97676:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644);function n(e){var t;let r=i.decompile(e);return 2===r.length&&i.isCanonicalScriptSignature(r[0])&&(t=r[1],i.isCanonicalPubKey(t)&&33===t.length)}t.check=n,n.toJSON=()=>"witnessPubKeyHash input"},82189:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644);function s(e){let t=i.compile(e);return 22===t.length&&t[0]===n.OPS.OP_0&&20===t[1]}t.check=s,s.toJSON=()=>"Witness pubKeyHash output"},83125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(38139);t.input=i;let n=r(12408);t.output=n},38139:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(48644),s=r(71764),u=r(91032),o=r(93263),a=r(13986);function p(e,t){if(s(s.Array,e),e.length<1)return!1;let r=e[e.length-1];if(!i.isBuffer(r))return!1;let p=n.decompile(r);if(!p||0===p.length)return!1;let c=n.compile(e.slice(0,-1));return!!(a.input.check(c)&&a.output.check(p)||u.input.check(c,t)&&u.output.check(p)||o.input.check(c)&&o.output.check(p))}t.check=p,p.toJSON=()=>"witnessScriptHash input"},12408:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(48644),n=r(48644);function s(e){let t=i.compile(e);return 34===t.length&&t[0]===n.OPS.OP_0&&32===t[1]}t.check=s,s.toJSON=()=>"Witness scriptHash output"},92789:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(54372),s=r(66432),u=r(48644),o=r(48644),a=r(11972),p=r(71764),c=r(61258);function l(e){let t=e.length;return c.encodingLength(t)+t}let h=i.allocUnsafe(0),f=[],d=i.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),y=i.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),g=i.from("ffffffffffffffff","hex"),m={script:h,valueBuffer:g};class _{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(e,t){let r=new n.BufferReader(e),i=new _;i.version=r.readInt32();let s=r.readUInt8(),u=r.readUInt8(),o=!1;s===_.ADVANCED_TRANSACTION_MARKER&&u===_.ADVANCED_TRANSACTION_FLAG?o=!0:r.offset-=2;let a=r.readVarInt();for(let e=0;e<a;++e)i.ins.push({hash:r.readSlice(32),index:r.readUInt32(),script:r.readVarSlice(),sequence:r.readUInt32(),witness:f});let p=r.readVarInt();for(let e=0;e<p;++e)i.outs.push({value:r.readUInt64(),script:r.readVarSlice()});if(o){for(let e=0;e<a;++e)i.ins[e].witness=r.readVector();if(!i.hasWitnesses())throw Error("Transaction has superfluous witness data")}if(i.locktime=r.readUInt32(),t)return i;if(r.offset!==e.length)throw Error("Transaction has unexpected data");return i}static fromHex(e){return _.fromBuffer(i.from(e,"hex"),!1)}static isCoinbaseHash(e){p(a.Hash256bit,e);for(let t=0;t<32;++t)if(0!==e[t])return!1;return!0}isCoinbase(){return 1===this.ins.length&&_.isCoinbaseHash(this.ins[0].hash)}addInput(e,t,r,i){return p(a.tuple(a.Hash256bit,a.UInt32,a.maybe(a.UInt32),a.maybe(a.Buffer)),arguments),a.Null(r)&&(r=_.DEFAULT_SEQUENCE),this.ins.push({hash:e,index:t,script:i||h,sequence:r,witness:f})-1}addOutput(e,t){return p(a.tuple(a.Buffer,a.Satoshi),arguments),this.outs.push({script:e,value:t})-1}hasWitnesses(){return this.ins.some(e=>0!==e.witness.length)}weight(){let e=this.byteLength(!1),t=this.byteLength(!0);return 3*e+t}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(e=!0){let t=e&&this.hasWitnesses();return(t?10:8)+c.encodingLength(this.ins.length)+c.encodingLength(this.outs.length)+this.ins.reduce((e,t)=>e+40+l(t.script),0)+this.outs.reduce((e,t)=>e+8+l(t.script),0)+(t?this.ins.reduce((e,t)=>e+function(e){let t=e.length;return c.encodingLength(t)+e.reduce((e,t)=>e+l(t),0)}(t.witness),0):0)}clone(){let e=new _;return e.version=this.version,e.locktime=this.locktime,e.ins=this.ins.map(e=>({hash:e.hash,index:e.index,script:e.script,sequence:e.sequence,witness:e.witness})),e.outs=this.outs.map(e=>({script:e.script,value:e.value})),e}hashForSignature(e,t,r){if(p(a.tuple(a.UInt32,a.Buffer,a.Number),arguments),e>=this.ins.length)return y;let n=u.compile(u.decompile(t).filter(e=>e!==o.OPS.OP_CODESEPARATOR)),c=this.clone();if((31&r)===_.SIGHASH_NONE)c.outs=[],c.ins.forEach((t,r)=>{r!==e&&(t.sequence=0)});else if((31&r)===_.SIGHASH_SINGLE){if(e>=this.outs.length)return y;c.outs.length=e+1;for(let t=0;t<e;t++)c.outs[t]=m;c.ins.forEach((t,r)=>{r!==e&&(t.sequence=0)})}r&_.SIGHASH_ANYONECANPAY?(c.ins=[c.ins[e]],c.ins[0].script=n):(c.ins.forEach(e=>{e.script=h}),c.ins[e].script=n);let l=i.allocUnsafe(c.byteLength(!1)+4);return l.writeInt32LE(r,l.length-4),c.__toBuffer(l,0,!1),s.hash256(l)}hashForWitnessV0(e,t,r,u){let o;p(a.tuple(a.UInt32,a.Buffer,a.Satoshi,a.UInt32),arguments);let c=i.from([]),h=d,f=d,y=d;if(u&_.SIGHASH_ANYONECANPAY||(c=i.allocUnsafe(36*this.ins.length),o=new n.BufferWriter(c,0),this.ins.forEach(e=>{o.writeSlice(e.hash),o.writeUInt32(e.index)}),f=s.hash256(c)),u&_.SIGHASH_ANYONECANPAY||(31&u)===_.SIGHASH_SINGLE||(31&u)===_.SIGHASH_NONE||(c=i.allocUnsafe(4*this.ins.length),o=new n.BufferWriter(c,0),this.ins.forEach(e=>{o.writeUInt32(e.sequence)}),y=s.hash256(c)),(31&u)!==_.SIGHASH_SINGLE&&(31&u)!==_.SIGHASH_NONE){let e=this.outs.reduce((e,t)=>e+8+l(t.script),0);c=i.allocUnsafe(e),o=new n.BufferWriter(c,0),this.outs.forEach(e=>{o.writeUInt64(e.value),o.writeVarSlice(e.script)}),h=s.hash256(c)}else if((31&u)===_.SIGHASH_SINGLE&&e<this.outs.length){let t=this.outs[e];c=i.allocUnsafe(8+l(t.script)),(o=new n.BufferWriter(c,0)).writeUInt64(t.value),o.writeVarSlice(t.script),h=s.hash256(c)}c=i.allocUnsafe(156+l(t)),o=new n.BufferWriter(c,0);let g=this.ins[e];return o.writeUInt32(this.version),o.writeSlice(f),o.writeSlice(y),o.writeSlice(g.hash),o.writeUInt32(g.index),o.writeVarSlice(t),o.writeUInt64(r),o.writeUInt32(g.sequence),o.writeSlice(h),o.writeUInt32(this.locktime),o.writeUInt32(u),s.hash256(c)}getHash(e){return e&&this.isCoinbase()?i.alloc(32,0):s.hash256(this.__toBuffer(void 0,void 0,e))}getId(){return n.reverseBuffer(this.getHash(!1)).toString("hex")}toBuffer(e,t){return this.__toBuffer(e,t,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(e,t){p(a.tuple(a.Number,a.Buffer),arguments),this.ins[e].script=t}setWitness(e,t){p(a.tuple(a.Number,[a.Buffer]),arguments),this.ins[e].witness=t}__toBuffer(e,t,r=!1){e||(e=i.allocUnsafe(this.byteLength(r)));let s=new n.BufferWriter(e,t||0);s.writeInt32(this.version);let u=r&&this.hasWitnesses();return(u&&(s.writeUInt8(_.ADVANCED_TRANSACTION_MARKER),s.writeUInt8(_.ADVANCED_TRANSACTION_FLAG)),s.writeVarInt(this.ins.length),this.ins.forEach(e=>{s.writeSlice(e.hash),s.writeUInt32(e.index),s.writeVarSlice(e.script),s.writeUInt32(e.sequence)}),s.writeVarInt(this.outs.length),this.outs.forEach(e=>{void 0!==e.value?s.writeUInt64(e.value):s.writeSlice(e.valueBuffer),s.writeVarSlice(e.script)}),u&&this.ins.forEach(e=>{s.writeVector(e.witness)}),s.writeUInt32(this.locktime),void 0!==t)?e.slice(t,s.offset):e}}_.DEFAULT_SEQUENCE=4294967295,_.SIGHASH_ALL=1,_.SIGHASH_NONE=2,_.SIGHASH_SINGLE=3,_.SIGHASH_ANYONECANPAY=128,_.ADVANCED_TRANSACTION_MARKER=0,_.ADVANCED_TRANSACTION_FLAG=1,t.Transaction=_},53360:function(e,t,r){"use strict";var i=r(1684).Buffer;Object.defineProperty(t,"__esModule",{value:!0});let n=r(78305),s=r(54372),u=r(41783),o=r(66432),a=r(6091),p=r(88909),c=r(76109),l=r(48644),h=r(48644),f=r(92789),d=r(11972),y=r(71764),g=u.types,m=new Set(["p2pkh","p2pk","p2wpkh","p2ms","p2sh-p2pkh","p2sh-p2pk","p2sh-p2wpkh","p2sh-p2ms","p2wsh-p2pkh","p2wsh-p2pk","p2wsh-p2ms","p2sh-p2wsh-p2pkh","p2sh-p2wsh-p2pk","p2sh-p2wsh-p2ms"]);function _(e,t,r){try{y(e,t)}catch(e){throw Error(r)}}class S{constructor(e=p.bitcoin,t=2500){this.network=e,this.maximumFeeRate=t,this.__PREV_TX_SET={},this.__INPUTS=[],this.__TX=new f.Transaction,this.__TX.version=2,this.__USE_LOW_R=!1,console.warn("Deprecation Warning: TransactionBuilder will be removed in the future. (v6.x.x or later) Please use the Psbt class instead. Examples of usage are available in the transactions-psbt.js integration test file on our Github. A high level explanation is available in the psbt.ts and psbt.js files as well.")}static fromTransaction(e,t){let r=new S(t);return r.setVersion(e.version),r.setLockTime(e.locktime),e.outs.forEach(e=>{r.addOutput(e.script,e.value)}),e.ins.forEach(e=>{r.__addInputUnsafe(e.hash,e.index,{sequence:e.sequence,script:e.script,witness:e.witness})}),r.__INPUTS.forEach((t,r)=>{(function(e,t,r){if(e.redeemScriptType!==g.P2MS||!e.redeemScript||e.pubkeys.length===e.signatures.length)return;let i=e.signatures.concat();e.signatures=e.pubkeys.map(n=>{let s;let u=a.fromPublicKey(n);return i.some((n,o)=>{if(!n)return!1;let a=l.signature.decode(n),p=t.hashForSignature(r,e.redeemScript,a.hashType);return!!u.verify(p,a.signature)&&(i[o]=void 0,s=n,!0)}),s})})(t,e,r)}),r}setLowR(e){return y(y.maybe(y.Boolean),e),void 0===e&&(e=!0),this.__USE_LOW_R=e,e}setLockTime(e){if(y(d.UInt32,e),this.__INPUTS.some(e=>!!e.signatures&&e.signatures.some(e=>void 0!==e)))throw Error("No, this would invalidate signatures");this.__TX.locktime=e}setVersion(e){y(d.UInt32,e),this.__TX.version=e}addInput(e,t,r,n){var u;let o;if(!this.__canModifyInputs())throw Error("No, this would invalidate signatures");if("string"==typeof(u=e)||u instanceof String)e=s.reverseBuffer(i.from(e,"hex"));else if(e instanceof f.Transaction){let r=e.outs[t];n=r.script,o=r.value,e=e.getHash(!1)}return this.__addInputUnsafe(e,t,{sequence:r,prevOutScript:n,value:o})}addOutput(e,t){if(!this.__canModifyOutputs())throw Error("No, this would invalidate signatures");return"string"==typeof e&&(e=n.toOutputScript(e,this.network)),this.__TX.addOutput(e,t)}build(){return this.__build(!1)}buildIncomplete(){return this.__build(!0)}sign(e,t,r,i,n,s){!function({input:e,ourPubKey:t,keyPair:r,signatureHash:i,hashType:n,useLowR:s}){let u=!1;for(let[o,a]of e.pubkeys.entries()){if(!t.equals(a))continue;if(e.signatures[o])throw Error("Signature already exists");if(33!==t.length&&e.hasWitness)throw Error("BIP143 rejects uncompressed public keys in P2WPKH or P2WSH");let p=r.sign(i,s);e.signatures[o]=l.signature.encode(p,n),u=!0}if(!u)throw Error("Key pair cannot sign for this input")}(function(e,t,r,i,n,s,u,o,a,p,h){let S;if("number"==typeof n)console.warn("DEPRECATED: TransactionBuilder sign method arguments will change in v6, please use the TxbSignArg interface"),S=n;else if("object"==typeof n)!function(e,t){if(!m.has(t.prevOutScriptType))throw TypeError(`Unknown prevOutScriptType "${t.prevOutScriptType}"`);_(y.Number,t.vin,"sign must include vin parameter as Number (input index)"),_(d.Signer,t.keyPair,"sign must include keyPair parameter as Signer interface"),_(y.maybe(y.Number),t.hashType,"sign hashType parameter must be a number");let r=(e[t.vin]||[]).prevOutType,i=t.prevOutScriptType;switch(i){case"p2pkh":if(r&&"pubkeyhash"!==r)throw TypeError(`input #${t.vin} is not of type p2pkh: ${r}`);_(y.value(void 0),t.witnessScript,`${i} requires NO witnessScript`),_(y.value(void 0),t.redeemScript,`${i} requires NO redeemScript`),_(y.value(void 0),t.witnessValue,`${i} requires NO witnessValue`);break;case"p2pk":if(r&&"pubkey"!==r)throw TypeError(`input #${t.vin} is not of type p2pk: ${r}`);_(y.value(void 0),t.witnessScript,`${i} requires NO witnessScript`),_(y.value(void 0),t.redeemScript,`${i} requires NO redeemScript`),_(y.value(void 0),t.witnessValue,`${i} requires NO witnessValue`);break;case"p2wpkh":if(r&&"witnesspubkeyhash"!==r)throw TypeError(`input #${t.vin} is not of type p2wpkh: ${r}`);_(y.value(void 0),t.witnessScript,`${i} requires NO witnessScript`),_(y.value(void 0),t.redeemScript,`${i} requires NO redeemScript`),_(d.Satoshi,t.witnessValue,`${i} requires witnessValue`);break;case"p2ms":if(r&&"multisig"!==r)throw TypeError(`input #${t.vin} is not of type p2ms: ${r}`);_(y.value(void 0),t.witnessScript,`${i} requires NO witnessScript`),_(y.value(void 0),t.redeemScript,`${i} requires NO redeemScript`),_(y.value(void 0),t.witnessValue,`${i} requires NO witnessValue`);break;case"p2sh-p2wpkh":if(r&&"scripthash"!==r)throw TypeError(`input #${t.vin} is not of type p2sh-p2wpkh: ${r}`);_(y.value(void 0),t.witnessScript,`${i} requires NO witnessScript`),_(y.Buffer,t.redeemScript,`${i} requires redeemScript`),_(d.Satoshi,t.witnessValue,`${i} requires witnessValue`);break;case"p2sh-p2ms":case"p2sh-p2pk":case"p2sh-p2pkh":if(r&&"scripthash"!==r)throw TypeError(`input #${t.vin} is not of type ${i}: ${r}`);_(y.value(void 0),t.witnessScript,`${i} requires NO witnessScript`),_(y.Buffer,t.redeemScript,`${i} requires redeemScript`),_(y.value(void 0),t.witnessValue,`${i} requires NO witnessValue`);break;case"p2wsh-p2ms":case"p2wsh-p2pk":case"p2wsh-p2pkh":if(r&&"witnessscripthash"!==r)throw TypeError(`input #${t.vin} is not of type ${i}: ${r}`);_(y.Buffer,t.witnessScript,`${i} requires witnessScript`),_(y.value(void 0),t.redeemScript,`${i} requires NO redeemScript`),_(d.Satoshi,t.witnessValue,`${i} requires witnessValue`);break;case"p2sh-p2wsh-p2ms":case"p2sh-p2wsh-p2pk":case"p2sh-p2wsh-p2pkh":if(r&&"scripthash"!==r)throw TypeError(`input #${t.vin} is not of type ${i}: ${r}`);_(y.Buffer,t.witnessScript,`${i} requires witnessScript`),_(y.Buffer,t.redeemScript,`${i} requires witnessScript`),_(d.Satoshi,t.witnessValue,`${i} requires witnessScript`)}}(t,n),{vin:S,keyPair:s,redeemScript:u,hashType:o,witnessValue:a,witnessScript:p}=n;else throw TypeError("TransactionBuilder sign first arg must be TxbSignArg or number");if(void 0===s)throw Error("sign requires keypair");if(s.network&&s.network!==e)throw TypeError("Inconsistent network");if(!t[S])throw Error("No input at index: "+S);if(r(o=o||f.Transaction.SIGHASH_ALL))throw Error("Transaction needs outputs");let b=t[S];if(void 0!==b.redeemScript&&u&&!b.redeemScript.equals(u))throw Error("Inconsistent redeemScript");let v=s.publicKey||s.getPublicKey&&s.getPublicKey();if(!E(b)){if(void 0!==a){if(void 0!==b.value&&b.value!==a)throw Error("Input did not match witnessValue");y(d.Satoshi,a),b.value=a}if(!E(b)){let e=function(e,t,r,i){if(r&&i){let n=c.p2wsh({redeem:{output:i}}),s=c.p2wsh({output:r}),u=c.p2sh({redeem:{output:r}}),o=c.p2sh({redeem:n});if(!n.hash.equals(s.hash))throw Error("Witness script inconsistent with prevOutScript");if(!u.hash.equals(o.hash))throw Error("Redeem script inconsistent with prevOutScript");let a=w(n.redeem.output,t);if(!a.pubkeys)throw Error(a.type+" not supported as witnessScript ("+l.toASM(i)+")");if(e.signatures&&e.signatures.some(e=>void 0!==e)&&(a.signatures=e.signatures),a.type===g.P2WPKH)throw Error("P2SH(P2WSH(P2WPKH)) is a consensus failure");return{redeemScript:r,redeemScriptType:g.P2WSH,witnessScript:i,witnessScriptType:a.type,prevOutType:g.P2SH,prevOutScript:u.output,hasWitness:!0,signScript:i,signType:a.type,pubkeys:a.pubkeys,signatures:a.signatures,maxSignatures:a.maxSignatures}}if(r){let i=c.p2sh({redeem:{output:r}});if(e.prevOutScript){let t;try{t=c.p2sh({output:e.prevOutScript})}catch(e){throw Error("PrevOutScript must be P2SH")}if(!i.hash.equals(t.hash))throw Error("Redeem script inconsistent with prevOutScript")}let n=w(i.redeem.output,t);if(!n.pubkeys)throw Error(n.type+" not supported as redeemScript ("+l.toASM(r)+")");e.signatures&&e.signatures.some(e=>void 0!==e)&&(n.signatures=e.signatures);let s=r;return n.type===g.P2WPKH&&(s=c.p2pkh({pubkey:n.pubkeys[0]}).output),{redeemScript:r,redeemScriptType:n.type,prevOutType:g.P2SH,prevOutScript:i.output,hasWitness:n.type===g.P2WPKH,signScript:s,signType:n.type,pubkeys:n.pubkeys,signatures:n.signatures,maxSignatures:n.maxSignatures}}if(i){let r=c.p2wsh({redeem:{output:i}});if(e.prevOutScript){let t=c.p2wsh({output:e.prevOutScript});if(!r.hash.equals(t.hash))throw Error("Witness script inconsistent with prevOutScript")}let n=w(r.redeem.output,t);if(!n.pubkeys)throw Error(n.type+" not supported as witnessScript ("+l.toASM(i)+")");if(e.signatures&&e.signatures.some(e=>void 0!==e)&&(n.signatures=e.signatures),n.type===g.P2WPKH)throw Error("P2WSH(P2WPKH) is a consensus failure");return{witnessScript:i,witnessScriptType:n.type,prevOutType:g.P2WSH,prevOutScript:r.output,hasWitness:!0,signScript:i,signType:n.type,pubkeys:n.pubkeys,signatures:n.signatures,maxSignatures:n.maxSignatures}}if(e.prevOutType&&e.prevOutScript){if(e.prevOutType===g.P2SH)throw Error("PrevOutScript is "+e.prevOutType+", requires redeemScript");if(e.prevOutType===g.P2WSH)throw Error("PrevOutScript is "+e.prevOutType+", requires witnessScript");if(!e.prevOutScript)throw Error("PrevOutScript is missing");let r=w(e.prevOutScript,t);if(!r.pubkeys)throw Error(r.type+" not supported ("+l.toASM(e.prevOutScript)+")");e.signatures&&e.signatures.some(e=>void 0!==e)&&(r.signatures=e.signatures);let i=e.prevOutScript;return r.type===g.P2WPKH&&(i=c.p2pkh({pubkey:r.pubkeys[0]}).output),{prevOutType:r.type,prevOutScript:e.prevOutScript,hasWitness:r.type===g.P2WPKH,signScript:i,signType:r.type,pubkeys:r.pubkeys,signatures:r.signatures,maxSignatures:r.maxSignatures}}let n=c.p2pkh({pubkey:t}).output;return{prevOutType:g.P2PKH,prevOutScript:n,hasWitness:!1,signScript:n,signType:g.P2PKH,pubkeys:[t],signatures:[void 0]}}(b,v,u,p);Object.assign(b,e)}if(!E(b))throw Error(b.prevOutType+" not supported")}return{input:b,ourPubKey:v,keyPair:s,signatureHash:b.hasWitness?i.hashForWitnessV0(S,b.signScript,b.value,o):i.hashForSignature(S,b.signScript,o),hashType:o,useLowR:!!h}}(this.network,this.__INPUTS,this.__needsOutputs.bind(this),this.__TX,e,t,r,i,n,s,this.__USE_LOW_R))}__addInputUnsafe(e,t,r){if(f.Transaction.isCoinbaseHash(e))throw Error("coinbase inputs not supported");let i=e.toString("hex")+":"+t;if(void 0!==this.__PREV_TX_SET[i])throw Error("Duplicate TxOut: "+i);let n={};if(void 0!==r.script&&(n=function e(t,r,i,n){if(0===t.length&&0===r.length)return{};if(!i){let e=u.input(t,!0),n=u.witness(r,!0);e===g.NONSTANDARD&&(e=void 0),n===g.NONSTANDARD&&(n=void 0),i=e||n}switch(i){case g.P2WPKH:{let{output:e,pubkey:t,signature:i}=c.p2wpkh({witness:r});return{prevOutScript:e,prevOutType:g.P2WPKH,pubkeys:[t],signatures:[i]}}case g.P2PKH:{let{output:e,pubkey:r,signature:i}=c.p2pkh({input:t});return{prevOutScript:e,prevOutType:g.P2PKH,pubkeys:[r],signatures:[i]}}case g.P2PK:{let{signature:e}=c.p2pk({input:t});return{prevOutType:g.P2PK,pubkeys:[void 0],signatures:[e]}}case g.P2MS:{let{m:e,pubkeys:r,signatures:i}=c.p2ms({input:t,output:n},{allowIncomplete:!0});return{prevOutType:g.P2MS,pubkeys:r,signatures:i,maxSignatures:e}}}if(i===g.P2SH){let{output:i,redeem:n}=c.p2sh({input:t,witness:r}),s=u.output(n.output),o=e(n.input,n.witness,s,n.output);return o.prevOutType?{prevOutScript:i,prevOutType:g.P2SH,redeemScript:n.output,redeemScriptType:o.prevOutType,witnessScript:o.witnessScript,witnessScriptType:o.witnessScriptType,pubkeys:o.pubkeys,signatures:o.signatures}:{}}if(i===g.P2WSH){let i;let{output:n,redeem:s}=c.p2wsh({input:t,witness:r}),o=u.output(s.output);return(i=o===g.P2WPKH?e(s.input,s.witness,o):e(l.compile(s.witness),[],o,s.output)).prevOutType?{prevOutScript:n,prevOutType:g.P2WSH,witnessScript:s.output,witnessScriptType:i.prevOutType,pubkeys:i.pubkeys,signatures:i.signatures}:{}}return{prevOutType:g.NONSTANDARD,prevOutScript:t}}(r.script,r.witness||[])),void 0!==r.value&&(n.value=r.value),!n.prevOutScript&&r.prevOutScript){let e;if(!n.pubkeys&&!n.signatures){let t=w(r.prevOutScript);t.pubkeys&&(n.pubkeys=t.pubkeys,n.signatures=t.signatures),e=t.type}n.prevOutScript=r.prevOutScript,n.prevOutType=e||u.output(r.prevOutScript)}let s=this.__TX.addInput(e,t,r.sequence,r.scriptSig);return this.__INPUTS[s]=n,this.__PREV_TX_SET[i]=!0,s}__build(e){if(!e){if(!this.__TX.ins.length)throw Error("Transaction has no inputs");if(!this.__TX.outs.length)throw Error("Transaction has no outputs")}let t=this.__TX.clone();if(this.__INPUTS.forEach((r,i)=>{if(!r.prevOutType&&!e)throw Error("Transaction is not complete");let n=function e(t,r,i){let n=r.pubkeys||[],s=r.signatures||[];switch(t){case g.P2PKH:if(0===n.length||0===s.length)break;return c.p2pkh({pubkey:n[0],signature:s[0]});case g.P2WPKH:if(0===n.length||0===s.length)break;return c.p2wpkh({pubkey:n[0],signature:s[0]});case g.P2PK:if(0===n.length||0===s.length)break;return c.p2pk({signature:s[0]});case g.P2MS:{let e=r.maxSignatures;s=i?s.map(e=>e||h.OPS.OP_0):s.filter(e=>e);let t=!i||e===s.length;return c.p2ms({m:e,pubkeys:n,signatures:s},{allowIncomplete:i,validate:t})}case g.P2SH:{let t=e(r.redeemScriptType,r,i);if(!t)return;return c.p2sh({redeem:{output:t.output||r.redeemScript,input:t.input,witness:t.witness}})}case g.P2WSH:{let t=e(r.witnessScriptType,r,i);if(!t)return;return c.p2wsh({redeem:{output:r.witnessScript,input:t.input,witness:t.witness}})}}}(r.prevOutType,r,e);if(!n){if(!e&&r.prevOutType===g.NONSTANDARD)throw Error("Unknown input type");if(!e)throw Error("Not enough information");return}t.setInputScript(i,n.input),t.setWitness(i,n.witness)}),!e&&this.__overMaximumFees(t.virtualSize()))throw Error("Transaction has absurd fees");return t}__canModifyInputs(){return this.__INPUTS.every(e=>!e.signatures||e.signatures.every(e=>{if(!e)return!0;let t=b(e);return(t&f.Transaction.SIGHASH_ANYONECANPAY)!=0}))}__needsOutputs(e){return e===f.Transaction.SIGHASH_ALL?0===this.__TX.outs.length:0===this.__TX.outs.length&&this.__INPUTS.some(e=>!!e.signatures&&e.signatures.some(e=>{if(!e)return!1;let t=b(e);return!(t&f.Transaction.SIGHASH_NONE)}))}__canModifyOutputs(){let e=this.__TX.ins.length,t=this.__TX.outs.length;return this.__INPUTS.every(r=>void 0===r.signatures||r.signatures.every(r=>{if(!r)return!0;let i=b(r),n=31&i;return n===f.Transaction.SIGHASH_NONE||n===f.Transaction.SIGHASH_SINGLE&&e<=t}))}__overMaximumFees(e){let t=this.__INPUTS.reduce((e,t)=>e+(t.value>>>0),0),r=this.__TX.outs.reduce((e,t)=>e+t.value,0);return(t-r)/e>this.maximumFeeRate}}function w(e,t){y(d.Buffer,e);let r=u.output(e);switch(r){case g.P2PKH:{if(!t)return{type:r};let i=c.p2pkh({output:e}).hash,n=o.hash160(t);if(!i.equals(n))return{type:r};return{type:r,pubkeys:[t],signatures:[void 0]}}case g.P2WPKH:{if(!t)return{type:r};let i=c.p2wpkh({output:e}).hash,n=o.hash160(t);if(!i.equals(n))return{type:r};return{type:r,pubkeys:[t],signatures:[void 0]}}case g.P2PK:{let t=c.p2pk({output:e});return{type:r,pubkeys:[t.pubkey],signatures:[void 0]}}case g.P2MS:{let t=c.p2ms({output:e});return{type:r,pubkeys:t.pubkeys,signatures:t.pubkeys.map(()=>void 0),maxSignatures:t.m}}}return{type:r}}function E(e){return void 0!==e.signScript&&void 0!==e.signType&&void 0!==e.pubkeys&&void 0!==e.signatures&&e.signatures.length===e.pubkeys.length&&e.pubkeys.length>0&&(!1===e.hasWitness||void 0!==e.value)}function b(e){return e.readUInt8(e.length-1)}t.TransactionBuilder=S},11972:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(71764);function n(e){return i.String(e)&&!!e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}t.UInt31=function(e){return i.UInt32(e)&&e<=2147483647},t.BIP32Path=n,n.toJSON=()=>"BIP32 derivation path",t.Signer=function(e){return(i.Buffer(e.publicKey)||"function"==typeof e.getPublicKey)&&"function"==typeof e.sign};let s=21*1e14;t.Satoshi=function(e){return i.UInt53(e)&&e<=s},t.ECPoint=i.quacksLike("Point"),t.Network=i.compile({messagePrefix:i.oneOf(i.Buffer,i.String),bip32:{public:i.UInt32,private:i.UInt32},pubKeyHash:i.UInt8,scriptHash:i.UInt8,wif:i.UInt8}),t.Buffer256bit=i.BufferN(32),t.Hash160bit=i.BufferN(20),t.Hash256bit=i.BufferN(32),t.Number=i.Number,t.Array=i.Array,t.Boolean=i.Boolean,t.String=i.String,t.Buffer=i.Buffer,t.Hex=i.Hex,t.maybe=i.maybe,t.tuple=i.tuple,t.UInt8=i.UInt8,t.UInt32=i.UInt32,t.Function=i.Function,t.BufferN=i.BufferN,t.Null=i.Null,t.oneOf=i.oneOf},4045:function(e,t,r){var i=r(1684).Buffer;e.exports=function(e,t){if(!Array.isArray(e))throw TypeError("Expected values Array");if("function"!=typeof t)throw TypeError("Expected digest Function");for(var r=e.length,n=e.concat();r>1;){for(var s=0,u=0;u<r;u+=2,++s){var o=n[u],a=u+1===r?o:n[u+1],p=i.concat([o,a]);n[s]=t(p)}r=s}return n[0]}},52043:function(e,t,r){var i=r(39991);function n(e){return e<i.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}e.exports={encodingLength:n,encode:function(e,t,r){var s=n(t);return 1===s?e.writeUInt8(t,r):2===s?(e.writeUInt8(i.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):3===s?(e.writeUInt8(i.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(i.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),s},decode:function(e,t){var r,n,s=e.readUInt8(t);if(s<i.OP_PUSHDATA1)r=s,n=1;else if(s===i.OP_PUSHDATA1){if(t+2>e.length)return null;r=e.readUInt8(t+1),n=2}else if(s===i.OP_PUSHDATA2){if(t+3>e.length)return null;r=e.readUInt16LE(t+1),n=3}else{if(t+5>e.length)return null;if(s!==i.OP_PUSHDATA4)throw Error("Unexpected opcode");r=e.readUInt32LE(t+1),n=5}return{opcode:s,number:r,size:n}}}},61258:function(e,t,r){"use strict";var i=r(70964).Buffer;function n(e){if(e<0||e>9007199254740991||e%1!=0)throw RangeError("value out of range")}function s(e,t,r){if(n(e),t||(t=i.allocUnsafe(o(e))),!i.isBuffer(t))throw TypeError("buffer must be a Buffer instance");return r||(r=0),e<253?(t.writeUInt8(e,r),s.bytes=1):e<=65535?(t.writeUInt8(253,r),t.writeUInt16LE(e,r+1),s.bytes=3):e<=4294967295?(t.writeUInt8(254,r),t.writeUInt32LE(e,r+1),s.bytes=5):(t.writeUInt8(255,r),t.writeUInt32LE(e>>>0,r+1),t.writeUInt32LE(e/4294967296|0,r+5),s.bytes=9),t}function u(e,t){if(!i.isBuffer(e))throw TypeError("buffer must be a Buffer instance");t||(t=0);var r=e.readUInt8(t);if(r<253)return u.bytes=1,r;if(253===r)return u.bytes=3,e.readUInt16LE(t+1);if(254===r)return u.bytes=5,e.readUInt32LE(t+1);u.bytes=9;var s=e.readUInt32LE(t+1),o=4294967296*e.readUInt32LE(t+5)+s;return n(o),o}function o(e){return n(e),e<253?1:e<=65535?3:e<=4294967295?5:9}e.exports={encode:s,decode:u,encodingLength:o}},39991:function(e){"use strict";e.exports=JSON.parse('{"OP_FALSE":0,"OP_0":0,"OP_PUSHDATA1":76,"OP_PUSHDATA2":77,"OP_PUSHDATA4":78,"OP_1NEGATE":79,"OP_RESERVED":80,"OP_TRUE":81,"OP_1":81,"OP_2":82,"OP_3":83,"OP_4":84,"OP_5":85,"OP_6":86,"OP_7":87,"OP_8":88,"OP_9":89,"OP_10":90,"OP_11":91,"OP_12":92,"OP_13":93,"OP_14":94,"OP_15":95,"OP_16":96,"OP_NOP":97,"OP_VER":98,"OP_IF":99,"OP_NOTIF":100,"OP_VERIF":101,"OP_VERNOTIF":102,"OP_ELSE":103,"OP_ENDIF":104,"OP_VERIFY":105,"OP_RETURN":106,"OP_TOALTSTACK":107,"OP_FROMALTSTACK":108,"OP_2DROP":109,"OP_2DUP":110,"OP_3DUP":111,"OP_2OVER":112,"OP_2ROT":113,"OP_2SWAP":114,"OP_IFDUP":115,"OP_DEPTH":116,"OP_DROP":117,"OP_DUP":118,"OP_NIP":119,"OP_OVER":120,"OP_PICK":121,"OP_ROLL":122,"OP_ROT":123,"OP_SWAP":124,"OP_TUCK":125,"OP_CAT":126,"OP_SUBSTR":127,"OP_LEFT":128,"OP_RIGHT":129,"OP_SIZE":130,"OP_INVERT":131,"OP_AND":132,"OP_OR":133,"OP_XOR":134,"OP_EQUAL":135,"OP_EQUALVERIFY":136,"OP_RESERVED1":137,"OP_RESERVED2":138,"OP_1ADD":139,"OP_1SUB":140,"OP_2MUL":141,"OP_2DIV":142,"OP_NEGATE":143,"OP_ABS":144,"OP_NOT":145,"OP_0NOTEQUAL":146,"OP_ADD":147,"OP_SUB":148,"OP_MUL":149,"OP_DIV":150,"OP_MOD":151,"OP_LSHIFT":152,"OP_RSHIFT":153,"OP_BOOLAND":154,"OP_BOOLOR":155,"OP_NUMEQUAL":156,"OP_NUMEQUALVERIFY":157,"OP_NUMNOTEQUAL":158,"OP_LESSTHAN":159,"OP_GREATERTHAN":160,"OP_LESSTHANOREQUAL":161,"OP_GREATERTHANOREQUAL":162,"OP_MIN":163,"OP_MAX":164,"OP_WITHIN":165,"OP_RIPEMD160":166,"OP_SHA1":167,"OP_SHA256":168,"OP_HASH160":169,"OP_HASH256":170,"OP_CODESEPARATOR":171,"OP_CHECKSIG":172,"OP_CHECKSIGVERIFY":173,"OP_CHECKMULTISIG":174,"OP_CHECKMULTISIGVERIFY":175,"OP_NOP1":176,"OP_NOP2":177,"OP_CHECKLOCKTIMEVERIFY":177,"OP_NOP3":178,"OP_CHECKSEQUENCEVERIFY":178,"OP_NOP4":179,"OP_NOP5":180,"OP_NOP6":181,"OP_NOP7":182,"OP_NOP8":183,"OP_NOP9":184,"OP_NOP10":185,"OP_PUBKEYHASH":253,"OP_PUBKEY":254,"OP_INVALIDOPCODE":255}')}}]);